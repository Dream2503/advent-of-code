#pragma once
#include "../utils.hpp"

class VirtualMachine {
public:
    enum class Status { RUNNING, SLEEPING, WAITING, HALTED } status;
    int pc, bp;
    std::vector<int64_t> opcodes;
    std::queue<int64_t> inputs, outputs;

    explicit VirtualMachine(const char* input) noexcept : status(Status::RUNNING), pc(0), bp(0) {
        std::stringstream ss(input);

        while (!ss.eof()) {
            int64_t opcode;
            (ss >> opcode).ignore(1);
            opcodes.push_back(opcode);
        }
    }

    Status interpret(int output_until = INT32_MAX) noexcept {
        auto ensure_size = [this](const int64_t size) mutable -> int64_t& {
            if (size >= opcodes.size()) {
                opcodes.resize(size + 1, 0);
            }
            return opcodes[size];
        };
        auto evaluate_lvalue = [this, ensure_size](const int mode, const int delta) mutable -> int64_t& {
            return mode ? ensure_size(bp + opcodes[pc + delta]) : ensure_size(opcodes[pc + delta]);
        };
        auto evaluate_rvalue = [this, ensure_size](const int mode, const int delta) mutable -> int64_t {
            return mode == 2 ? ensure_size(bp + opcodes[pc + delta]) : mode ? opcodes[pc + delta] : ensure_size(opcodes[pc + delta]);
        };
        status = Status::RUNNING;

        while (status == Status::RUNNING) {
            int code = opcodes[pc] / 100;
            const int opcode = opcodes[pc] % 100, mode1 = code % 10;
            code /= 10;
            const int mode2 = code % 10;
            code /= 10;
            const int mode3 = code % 10;

            switch (opcode) {
            case 1:
                evaluate_lvalue(mode3, 3) = evaluate_rvalue(mode1, 1) + evaluate_rvalue(mode2, 2);
                pc += 4;
                break;

            case 2:
                evaluate_lvalue(mode3, 3) = evaluate_rvalue(mode1, 1) * evaluate_rvalue(mode2, 2);
                pc += 4;
                break;

            case 3:
                if (inputs.empty()) {
                    status = Status::WAITING;
                    break;
                }
                evaluate_lvalue(mode1, 1) = inputs.front();
                inputs.pop();
                pc += 2;
                break;

            case 4:
                outputs.push(evaluate_rvalue(mode1, 1));
                pc += 2;
                status = --output_until ? status : Status::SLEEPING;
                break;

            case 5:
                pc = evaluate_rvalue(mode1, 1) ? evaluate_rvalue(mode2, 2) : pc + 3;
                break;

            case 6:
                pc = evaluate_rvalue(mode1, 1) ? pc + 3 : evaluate_rvalue(mode2, 2);
                break;

            case 7:
                evaluate_lvalue(mode3, 3) = evaluate_rvalue(mode1, 1) < evaluate_rvalue(mode2, 2);
                pc += 4;
                break;

            case 8:
                evaluate_lvalue(mode3, 3) = evaluate_rvalue(mode1, 1) == evaluate_rvalue(mode2, 2);
                pc += 4;
                break;

            case 9:
                bp += evaluate_rvalue(mode1, 1);
                pc += 2;
                break;

            default:
                status = Status::HALTED;
            }
        }
        return status;
    }
};

constexpr char input1[] = R"(137569
146535
74662
133844
99969
86606
76237
52902
106211
141865
50865
101011
75956
67501
142146
107706
83492
137253
56296
141256
118232
127402
67455
64062
72416
109547
106144
54832
57057
74884
80923
85121
60461
92743
134175
65671
90198
134055
59568
146576
134488
130355
54782
51370
55501
56555
62140
99558
80875
113451
71048
64890
94481
87468
148972
81742
79471
100999
106741
142433
130225
58789
134365
81310
102004
92736
105542
63097
92747
109214
103305
143659
68254
126409
71724
50284
125431
132227
125600
99131
96598
101007
123104
82215
97310
135824
117379
81546
109472
85571
89292
109530
127656
56654
132463
101948
118835
59125
116089
61605)";

constexpr char input2[] =
    "1,0,0,3,1,1,2,3,1,3,4,3,1,5,0,3,2,1,6,19,1,5,19,23,1,23,6,27,1,5,27,31,1,31,6,35,1,9,35,39,2,10,39,43,1,43,6,47,2,6,47,51,1,5,51,55,1,55,13,59,"
    "1,59,10,63,2,10,63,67,1,9,67,71,2,6,71,75,1,5,75,79,2,79,13,83,1,83,5,87,1,87,9,91,1,5,91,95,1,5,95,99,1,99,13,103,1,10,103,107,1,107,9,111,1,6,"
    "111,115,2,115,13,119,1,10,119,123,2,123,6,127,1,5,127,131,1,5,131,135,1,135,6,139,2,139,10,143,2,143,9,147,1,147,6,151,1,151,13,155,2,155,9,159,"
    "1,6,159,163,1,5,163,167,1,5,167,171,1,10,171,175,1,13,175,179,1,179,2,183,1,9,183,0,99,2,14,0,0";

constexpr char input3[] =
    R"(R1007,D949,R640,D225,R390,D41,R257,D180,L372,U62,L454,U594,L427,U561,R844,D435,L730,U964,L164,U342,R293,D490,L246,U323,L14,D366,L549,U312,L851,U959,L255,U947,L179,U109,R850,D703,L310,U175,L665,U515,R23,D633,L212,U650,R477,U131,L838,D445,R999,D229,L772,U716,L137,U355,R51,D565,L410,D493,L312,U623,L846,D283,R980,U804,L791,U918,L641,U258,R301,U727,L307,U970,L748,U229,L225,U997,L134,D707,L655,D168,L931,D6,R36,D617,L211,D453,L969,U577,R299,D804,R910,D898,R553,U298,L309,D912,R757,U581,R228,U586,L331,D865,R606,D163,R425,U670,R156,U814,L168,D777,R674,D970,L64,U840,L688,U144,L101,U281,L615,D393,R277,U990,L9,U619,L904,D967,L166,U839,L132,U216,R988,U834,R342,U197,L717,U167,L524,U747,L222,U736,L149,D156,L265,U657,L72,D728,L966,U896,R45,D985,R297,U38,R6,D390,L65,D367,R806,U999,L840,D583,R646,U43,L731,D929,L941,D165,R663,U645,L753,U619,R60,D14,L811,D622,L835,U127,L475,D494,R466,U695,R809,U446,R523,D403,R843,U715,L486,D661,L584,U818,L377,D857,L220,U309,R192,U601,R253,D13,L95,U32,L646,D983,R13,U821,L1,U309,L425,U993,L785,U804,L663,U699,L286,U280,R237,U388,L170,D222,L900,U204,R68,D453,R721,U326,L629,D44,R925,D347,R264,D767,L785,U249,R989,D469,L446,D384,L914,U444,R741,U90,R424,U107,R98,U20,R302,U464,L808,D615,R837,U405,L191,D26,R661,D758,L866,D640,L675,U135,R288,D357,R316,D127,R599,U411,R664,D584,L979,D432,R887,D104,R275,D825,L338,D739,R568,D625,L829,D393,L997,D291,L448,D947,L728,U181,L137,D572,L16,U358,R331,D966,R887,D122,L334,D560,R938,D159,R178,D29,L832,D58,R374
L993,U121,L882,U500,L740,D222,R574,U947,L541,U949,L219,D492,R108,D621,L875,D715,R274,D858,R510,U668,R677,U327,L284,U537,L371,U810,L360,U333,L926,D144,R162,U750,L741,D360,R792,D256,L44,D893,R969,D996,L905,D524,R538,U141,R70,U347,L383,U74,R893,D560,L39,U447,L205,D783,L244,D40,R374,U507,L946,D934,R962,D138,L584,U562,L624,U69,L77,D137,L441,U671,L849,D283,L742,D459,R105,D265,R312,D734,R47,D369,R676,D429,R160,D814,L881,D830,R395,U598,L413,U817,R855,D377,L338,D413,L294,U321,L714,D217,L15,U341,R342,D480,R660,D11,L192,U518,L654,U13,L984,D866,R877,U801,R413,U66,R269,D750,R294,D143,R929,D786,R606,U816,L562,U938,R484,U32,R136,U30,L393,U209,L838,U451,L387,U413,R518,D9,L847,D605,L8,D805,R348,D174,R865,U962,R926,U401,R445,U720,L843,U785,R287,D656,L489,D465,L192,U68,L738,U962,R384,U288,L517,U396,L955,U556,R707,U329,L589,U604,L583,U457,R545,D504,L521,U711,L232,D329,L110,U167,R311,D234,R284,D984,L778,D295,R603,U349,R942,U81,R972,D505,L301,U422,R840,U689,R225,D780,R379,D200,R57,D781,R166,U245,L865,U790,R654,D127,R125,D363,L989,D976,R993,U702,L461,U165,L747,U656,R617,D115,L783,U187,L462,U838,R854,D516,L978,U846,R203,D46,R833,U393,L322,D17,L160,D278,R919,U611,L59,U709,L472,U871,L377,U111,L612,D177,R712,U628,R858,D54,L612,D303,R205,U430,R494,D306,L474,U848,R816,D104,L967,U886,L866,D366,L120,D735,R694,D335,R399,D198,R132,D787,L749,D612,R525,U163,R660,U316,R482,D412,L376,U170,R891,D202,R408,D333,R842,U965,R955,U440,L26,U747,R447,D8,R319,D188,L532,D39,L863,D599,R307,U253,R22)";

constexpr char input4[] = "134792-675810";

constexpr char input5[] =
    "3,225,1,225,6,6,1100,1,238,225,104,0,1102,68,5,225,1101,71,12,225,1,117,166,224,1001,224,-100,224,4,224,102,8,223,223,101,2,224,224,1,223,224,"
    "223,1001,66,36,224,101,-87,224,224,4,224,102,8,223,223,101,2,224,224,1,223,224,223,1101,26,51,225,1102,11,61,224,1001,224,-671,224,4,224,1002,"
    "223,8,223,1001,224,5,224,1,223,224,223,1101,59,77,224,101,-136,224,224,4,224,1002,223,8,223,1001,224,1,224,1,223,224,223,1101,11,36,225,1102,31,"
    "16,225,102,24,217,224,1001,224,-1656,224,4,224,102,8,223,223,1001,224,1,224,1,224,223,223,101,60,169,224,1001,224,-147,224,4,224,102,8,223,223,"
    "101,2,224,224,1,223,224,223,1102,38,69,225,1101,87,42,225,2,17,14,224,101,-355,224,224,4,224,102,8,223,223,1001,224,2,224,1,224,223,223,1002,"
    "113,89,224,101,-979,224,224,4,224,1002,223,8,223,1001,224,7,224,1,224,223,223,1102,69,59,225,4,223,99,0,0,0,677,0,0,0,0,0,0,0,0,0,0,0,1105,0,"
    "99999,1105,227,247,1105,1,99999,1005,227,99999,1005,0,256,1105,1,99999,1106,227,99999,1106,0,265,1105,1,99999,1006,0,99999,1006,227,274,1105,1,"
    "99999,1105,1,280,1105,1,99999,1,225,225,225,1101,294,0,0,105,1,0,1105,1,99999,1106,0,300,1105,1,99999,1,225,225,225,1101,314,0,0,106,0,0,1105,1,"
    "99999,7,677,677,224,1002,223,2,223,1006,224,329,1001,223,1,223,1007,226,226,224,1002,223,2,223,1006,224,344,1001,223,1,223,1108,226,677,224,102,"
    "2,223,223,1005,224,359,1001,223,1,223,1107,226,677,224,1002,223,2,223,1006,224,374,101,1,223,223,1107,677,226,224,1002,223,2,223,1006,224,389,"
    "101,1,223,223,7,226,677,224,1002,223,2,223,1005,224,404,101,1,223,223,1008,677,226,224,102,2,223,223,1005,224,419,101,1,223,223,1008,226,226,"
    "224,102,2,223,223,1006,224,434,101,1,223,223,107,226,226,224,1002,223,2,223,1005,224,449,1001,223,1,223,108,226,677,224,102,2,223,223,1005,224,"
    "464,101,1,223,223,1108,677,226,224,102,2,223,223,1005,224,479,101,1,223,223,1007,226,677,224,102,2,223,223,1006,224,494,101,1,223,223,107,677,"
    "677,224,102,2,223,223,1005,224,509,101,1,223,223,108,677,677,224,102,2,223,223,1006,224,524,1001,223,1,223,8,226,677,224,102,2,223,223,1005,224,"
    "539,101,1,223,223,107,677,226,224,102,2,223,223,1005,224,554,1001,223,1,223,8,226,226,224,102,2,223,223,1006,224,569,1001,223,1,223,7,677,226,"
    "224,1002,223,2,223,1005,224,584,1001,223,1,223,1108,226,226,224,102,2,223,223,1005,224,599,1001,223,1,223,1107,677,677,224,1002,223,2,223,1006,"
    "224,614,1001,223,1,223,1007,677,677,224,1002,223,2,223,1006,224,629,1001,223,1,223,108,226,226,224,102,2,223,223,1005,224,644,1001,223,1,223,8,"
    "677,226,224,1002,223,2,223,1005,224,659,1001,223,1,223,1008,677,677,224,1002,223,2,223,1006,224,674,1001,223,1,223,4,223,99,226";

constexpr char input6[] = R"(WGB)S14
WN4)27C
18L)M18
1HY)6ZP
TQ9)KQ6
HQ3)HH1
FLC)F1Z
D6R)ZPC
2VD)GK3
YY3)3TP
PBL)3CK
5K4)CB5
V5M)CNN
L4T)RHS
HHH)66F
Q3Y)DTL
DGN)YY3
CCT)L3B
Z6X)FM2
2QQ)VK9
MX3)C9J
4JK)BPX
8BP)N13
PBW)6Z6
2LT)DT9
JHX)GXM
5LW)BHQ
DNK)ZBT
29Z)T9D
WNP)TDC
S38)GL6
DW9)V2F
4MG)3FW
Z9Z)CPK
FKL)QNH
55D)HT2
D1D)N4Q
Y7W)1Y8
SFQ)79W
JSR)62W
4WN)J18
VK9)J2H
LS5)DCX
6LR)P4X
HDV)DGQ
1K9)KD1
2PX)17C
KSB)GL8
B4S)VTV
ZW1)KNR
BVH)43P
VKP)6L3
P5K)MHR
XHR)STT
WBG)5X5
HZF)8JQ
B47)NW4
J5V)3ZW
KGP)VVR
24K)PK8
31V)LXC
5XG)RHP
P1G)HN8
R76)3GY
5CH)17Q
TVC)XJM
598)RD3
J66)LKC
4DY)YSQ
M4Y)NLL
SMP)M2M
TBR)WNP
K22)KGP
MQ5)8MN
B9Q)6HQ
P9S)X92
TJK)ZQK
XS7)7KL
H6J)DX1
MTP)3Z6
B17)B7P
S12)PC2
47V)5KW
KCY)HWP
FB2)S38
V5M)FNT
GXM)QPR
HXR)2R2
2LV)NDP
6HQ)12S
22P)4HL
T8Q)9FB
8YW)TVZ
DR1)NNN
9TH)87Z
79W)TM2
5GB)HQM
1HY)4WN
LFV)RYJ
YCN)ZMK
8SR)SB3
P9H)PH9
ZGQ)T3J
KWW)1HY
TLF)RPG
PFD)HZR
9SF)7PY
DCX)VCC
D1R)2RB
GXC)NN9
ZZW)SCC
G44)Q8D
923)3J2
KY2)8F4
1XQ)7LD
GHX)Q6M
TZ5)V32
LM9)1XK
Q7N)Z7H
YKD)73H
9RZ)C2Q
5KN)P1G
3FJ)L73
ZPC)VYT
Y7D)FFY
C8W)J1Y
X5T)55D
Z3F)GK8
WRS)PRR
T9M)JK2
81P)5WT
7KL)5BK
S3R)VCD
56L)D1R
PR2)92L
91F)2F4
ND4)PJ6
9KY)YD4
CLH)5D7
J2F)L7Z
M4Y)PYG
891)P34
VV6)18L
RQQ)X8P
7SR)8G6
WJ8)CDL
9FB)TXD
RKK)2H5
3W8)2QQ
27C)YFC
RZZ)91F
4CP)BWH
T4L)LS5
788)G7S
47V)3W8
FGK)719
16Q)4KW
5H6)PC9
KGS)TBR
44Y)BVH
GMF)VFM
LKC)PM4
DPL)DXS
2WD)X5T
XWX)NYR
N44)Y36
72S)56L
W25)4MG
P9S)HBC
W84)3YP
NW4)S78
58Y)LDB
QJ9)VV1
5D3)4Q7
T3J)5M4
394)ZW7
JXL)QVK
7KL)FTL
885)ZGQ
58Y)8SR
GXN)PBW
HH1)JB4
H6J)W95
VYK)SQS
CCS)7CZ
PJ7)NLR
2VW)MSP
ZWK)H6X
HJ4)C1S
H41)1L3
8B9)64N
RZR)WBJ
FNT)VL7
K5M)S5Q
XJM)TC7
QWT)7Q5
43P)MY2
YP7)51N
TDX)FWZ
DB3)NCK
37M)H2L
Z3X)XRS
SGV)R2T
Y2F)63M
ZVY)JTX
DJB)KQD
848)FQP
SX3)FM5
PH9)ZPG
75S)Z9L
GPD)Y7D
9Y6)52N
SL4)S3R
4TH)T6F
K4V)D8V
89S)18F
GDN)WN4
6HT)TQZ
V1Q)JVG
R55)2LC
KH3)NT5
Q53)3DN
SRV)JND
XMC)MKK
T5J)6HT
HZR)M1M
P34)3RY
HF6)SD2
PTM)C9X
3MZ)T9M
R76)MFF
B9Y)3MC
NFG)5FC
M63)4CP
FRG)PVQ
58Z)GDM
ZT8)4L5
F5B)KF3
SQT)NTZ
M2M)252
35Y)5WF
C9J)8BP
W8H)F78
H8Z)2VW
91P)5FP
VTV)YN7
2KM)1K9
KSX)TR8
9DK)XD6
MFF)KQR
414)6L9
FQ7)T5K
G8M)WPX
794)FMS
WZV)XS7
VVR)5CH
R8G)9RH
B4D)2RT
PJ6)GWB
63M)NHF
8G7)8B9
QP5)9ZW
FW6)CDM
S5Q)172
T24)TPD
YRT)GMF
1TJ)SGV
RV3)C3D
661)MHS
QYT)D2K
T49)MFP
GY7)T2Q
686)Z4G
J49)R9L
R5S)67X
L7Z)5RM
RPP)WG9
5KW)2KM
5N2)Y7W
Z3X)JFD
KD8)4H5
5MP)RVK
12S)S2Y
TPD)D5F
51N)81P
DCH)SGQ
L6N)VKP
2XQ)6LR
3DN)S3L
VS4)83N
8DJ)WZP
DCX)FX1
SF9)Z3F
R49)S99
D1C)794
TKN)L83
21R)GP3
5RM)TG3
ZMK)R49
1QT)152
9DX)GXC
GYC)TQ9
JND)LMK
D8Z)SCW
VNZ)VS4
C1S)9RZ
LKF)D8Z
G4J)R44
92L)J66
88P)657
8Z5)R55
VV1)KRY
N44)2QK
KBC)KKG
91P)L6N
SVH)7W3
P9Z)34H
BWH)9TH
JNX)RZZ
YFG)ZT8
DSM)FF3
BMK)ZR6
7W3)V82
T9D)H2S
2QF)PFD
NDQ)F13
ZVB)MX6
KRY)7FB
KKG)HJ4
QNH)MFQ
5X5)VQM
HQM)HF6
HLT)TD2
WV4)FWH
N2T)5B5
D1R)P89
HKT)3MZ
ZQK)1DK
QQQ)FLC
73Z)TTM
ZZW)769
8G7)TYL
MFP)WMS
RQS)2YC
NLL)JHX
KCY)CSP
9F8)51H
SGQ)B27
4KM)VYK
JDY)MTW
T8Q)DB3
1VL)VV6
VV5)B4D
SPF)JR5
LYS)6CK
YMK)2VD
TD2)1VL
JKH)QHX
VD4)58J
9QQ)HKL
8JP)HQ3
NHS)31S
81Z)Q5W
R7Q)Z9M
WMS)ZK2
3J2)GY7
MFQ)CLH
S14)934
HY7)YBT
4SY)63F
NQF)PPQ
T9W)RZR
WL2)6QM
LZV)WRQ
TVZ)T9P
4X5)GN5
NQ8)FPQ
J5J)K51
Y8T)WGM
FPQ)B53
1XK)TKX
XDW)72V
WW8)9QQ
XX7)Q7N
CDM)GHX
VCC)HPP
QRK)56B
MTW)2QT
7V5)58Z
PYY)T24
9HB)J8F
TTM)PTB
FF3)ZY3
ZW7)D1D
T4H)ZTG
2PW)DSM
9WB)4TH
17C)FKX
T6F)QP3
G6R)XHR
H5T)QYT
DX1)Q9L
GJF)ZF3
LJP)JXL
QHX)3XY
DNF)8KQ
8Q1)NDQ
GP3)6MY
FPQ)QQQ
XRS)923
Q6M)7BS
K21)B47
TQZ)WJ4
9PB)3PQ
8G6)X7M
L3B)YOU
L5V)G2L
B8Y)JVS
GL6)MTP
9QZ)NRN
486)T8Q
HNN)PNM
NFK)B4S
G9C)LHT
4K9)SL4
8X5)179
VQM)47V
CNJ)J4R
ZD5)2PX
9TQ)X9Q
Q3Q)9DK
17Q)1KX
5GN)24K
K5Q)1NF
LCK)9WB
TYL)PYL
7XG)R2L
LXC)ZWK
Q62)SPF
89C)N7Z
GK8)GR7
6X1)5N2
XM8)8Q1
MCD)GXQ
S2Y)N7G
CB5)C8W
NHF)44B
QPR)GF5
HGX)YMY
3FW)2LV
5WF)RQQ
841)N31
Q9L)876
WQ8)HZ7
6K1)QVC
C2T)FQX
J3M)HLT
H2S)K5Q
STQ)8ZF
VDX)NQF
YSR)G8M
CSL)NLF
MHS)3FH
YN7)VWC
RSW)X11
FXS)L54
YBT)HX4
BHQ)FRG
83H)K4Q
NT5)2ZB
GWB)4K9
YMY)5KN
4Q7)C3G
D3J)HZF
32D)GN7
VGG)G3D
LVG)JXR
25V)GDN
L6V)KL8
FW2)STQ
V6H)8G7
COM)CB6
6Z6)SQT
W81)6M3
D2K)XF6
2NX)9KY
KRQ)LKF
P1B)VVQ
QTV)Q3Y
DTZ)ZLY
R3T)FQ7
D92)72S
H8N)9Y6
FWZ)WGB
VQW)LHJ
2HB)848
9ZW)NT8
NLR)QTV
31V)DSZ
92J)WXY
8LK)QQ3
769)ZD5
8L9)T5J
TB2)V5M
VZQ)57T
Z7H)JMR
94D)YCN
ZPF)6WK
M1F)6C2
MHV)ZCS
Q53)FBC
RPG)P3N
RHS)JDY
FTL)FB2
J47)R3T
Y9S)4JK
ZVY)TK6
LTX)BM5
D8V)3R6
J18)S19
PVQ)WL2
ZPV)QFW
719)CSV
XK9)9Q9
BM5)L5V
LDF)WZT
MSP)DTZ
HRQ)JBG
19C)GSP
GPB)HGX
2F4)8HL
886)C8J
ZF3)LM9
NQ1)394
WM9)M79
PM4)GNT
6J4)ML2
5WT)HQS
KQD)5K4
JBT)V1Q
JVS)DDT
3G2)52L
8ZF)D6R
4BQ)5H6
G7T)7T6
ZY3)83H
HYC)G9C
MX6)XC9
2NW)2SH
YXJ)JSR
QNH)YJN
TG3)886
N7Z)G98
5D7)KNW
8TN)KH3
C78)TSW
87Z)DFM
QGG)Q53
NRN)YP7
TTB)C2T
ZLY)25P
7KS)D5X
LNX)CNJ
QVK)YMK
CNN)N43
5Q9)MWG
SCC)XFV
885)G7T
4BS)4BQ
N4Q)Z6X
FQX)7W4
MLL)NF8
52N)PZ2
DNF)KBC
6C2)CCS
LZ8)P1B
CSV)686
PZ2)KKC
JMR)327
3TP)N6L
3W8)YFG
S62)J5V
FF3)VXL
4X4)MHQ
3TP)7Z7
L83)VDN
Q8D)2HB
JB4)5LR
VYT)SAN
L54)X63
15J)XF2
FWZ)WLR
R44)K5M
TK6)Q5J
J81)QP5
114)BGP
QQ3)PJ7
D5F)HNN
MFF)WW8
J18)MP3
9JN)M8G
2YC)CSL
R2T)4TS
ZBT)WQ8
XFV)MPD
R9S)XDW
8HL)99X
4MG)2QF
8X5)BMK
CN7)KSB
YJN)44Y
X11)WWY
5MP)VDX
R2L)PFY
6ZP)HPW
WGM)GPB
WCZ)KCY
NYR)TKN
1L3)SKC
MND)S5K
17N)2D1
VL7)16Q
5FP)J5J
NBL)TLF
QDV)Z9Z
2S1)VXW
K22)G6R
DTL)9Z8
BXN)YXJ
VYW)LNX
WJ4)4LM
JTX)DPL
SLM)DNF
YM4)J37
4L5)BF4
2RT)8DD
FNB)KD8
PK8)9PD
RLR)4SY
TM2)661
PQ6)2FF
92J)XMC
GDM)21R
ZTG)VV5
X3B)ZZW
5XQ)H6J
WTL)W1N
PNM)H8Z
6MY)CG5
72V)RLR
3R6)WCZ
PF8)YRM
HPY)88T
X8P)MHN
7LY)6VJ
2FF)C9G
K4Q)4BS
X63)2WD
XM8)R8Q
G98)Z3X
44B)8DJ
PWZ)V1P
MDD)7ZX
RRD)T49
YBJ)DBX
GXQ)BXP
6FX)88P
WXZ)H22
18F)WTL
NQF)885
L4T)XM2
V82)4DY
6N6)TDX
172)QRK
N6L)23T
CSP)5MP
GLG)9TQ
9P6)R76
W1N)N3F
R8G)JZ1
H2L)F2D
TGT)C9S
7BS)2XQ
FWH)TVM
23T)K3L
WQX)37M
3ZW)QH7
BGP)FW6
YFC)FGH
JCF)94D
WRQ)9JN
GN5)6RM
V6H)QGG
C1S)XK9
FFY)9SF
WPX)HKT
7Y1)NBL
6RN)GPD
NYJ)YDT
934)FKL
P3N)FXS
ZQS)KXC
4KW)PVJ
FMS)V26
NT8)WM9
7Z7)G4J
NN9)2TT
VXW)DJB
C97)Q3Q
VVQ)486
CB6)DGN
DGQ)WMN
FM5)GJF
6YY)DPN
DDT)814
KF3)SFQ
G7S)TTB
R4C)S12
R8Q)35Y
GXN)JKH
J2H)K22
F5B)7LY
NCK)YSR
SMP)KY2
P4X)X3B
DR5)LZ8
8JQ)ZPV
WG9)SX3
NDQ)LM2
32S)LFV
K51)ND4
DP3)QDV
2W7)CCT
RSK)YH6
9NZ)NSB
K3L)RV3
HN8)414
92N)75S
61M)598
ZR6)53T
J8F)TB2
H22)5YX
HSJ)M63
4KW)5GB
HR7)89C
FQP)15J
TZ5)LYS
5FP)WG4
4HL)PBL
C8J)D1C
TS3)83C
C3G)1QT
GZD)DNK
2RB)KSF
BCD)SF9
327)9QZ
4FF)ZQS
6L9)82F
TJK)123
X9M)FMY
R92)TV1
CDL)2PW
7ZX)58Y
C2N)H5T
8MN)TH2
GN7)G44
HKL)61M
XD6)1C9
ZCS)NQ8
2L8)QGH
DFC)XX7
S5K)XM8
58J)8L9
PRR)4KM
6XT)N2T
FM2)7Y1
V26)HR7
2TT)91P
88F)ZW1
JBG)891
WZT)VZQ
PYG)NHS
2QT)P9H
FB2)9QT
MP3)PQ6
WZV)YBJ
H53)VYW
N2T)VQW
ZK2)6RT
SQS)5XQ
DPN)W8H
TSW)2L8
73H)R7Q
F1Z)B9Q
M8G)9KS
NSB)H41
WBJ)THR
KSF)KGS
PXH)3BS
4NT)ZRV
VNZ)8X5
98S)DR1
3XY)TJK
JNX)P9Z
F4P)6YY
VRT)VKV
TVM)92N
WLR)S62
D5X)ZVB
152)9P6
F2D)PN3
2R2)D6K
ZRV)2NX
67X)TS3
HWP)YBD
5FC)SRV
X92)CQR
8N9)DFC
Q5J)H8N
GGG)8LK
PPQ)841
6RT)WJ8
KQR)788
92N)Q62
W7S)98S
S19)NFK
VRM)ZVY
GL8)DCH
4YM)17N
F13)D3J
QVC)VGG
31S)J81
934)93X
Q21)R4C
TH2)HQ4
1C9)114
83N)X5B
S3L)T4L
SD2)ZWX
SC1)6K1
TXD)ZPF
3GY)NQ1
Z9M)9NS
D6R)7V5
WG4)C2N
SVH)JBT
TR8)K4V
MPD)7SR
Y36)DP3
LM2)K21
KD1)2S1
FC8)J3M
JFD)BWF
6Y3)88F
STT)GXN
KKC)DW9
52L)B3G
5BK)XWX
H6X)5BQ
YH6)FGK
VM3)6RN
BWH)1PZ
JK2)BCD
9QT)LTX
6WK)F5B
HYC)C97
GSP)3MR
6M3)B9P
7LD)9NZ
N31)7KS
GGG)9PB
6RM)SC1
83C)TGT
BWT)1TJ
7YH)CN7
JLD)PFT
W95)JNX
ZBT)Y2F
TPD)RSK
3BS)BR6
KG9)X9M
6HL)5D3
WMN)P9S
V32)V6H
RYJ)3HM
SF9)SBK
HQ4)19C
BWF)2W7
2LC)91R
VCD)3G2
VKJ)9BJ
NL2)VKJ
NLF)HY7
BR6)L6V
TQ4)8N9
QH7)W84
D6K)GGG
W1J)SLM
DB2)RQS
M18)RRD
DXS)32S
KL8)YRT
Q5W)VD4
SCC)WQX
GQW)VRT
52N)J47
Z9M)6FX
FKX)GSK
TKX)WRS
7YH)NFG
9Y6)WZV
7BS)48W
NT5)KSX
1Y8)RYV
814)J2F
GSK)KRQ
FBC)W1J
C9G)VRY
V2F)8TN
5M4)Y9S
X9Q)T71
Q7G)9HB
YLR)4YM
18L)29D
M1M)1BT
82F)MX3
9BJ)BBL
R55)HRQ
9RH)R5S
414)MHV
ML2)Y8T
179)7YH
GK3)5Q9
7CZ)VRM
QP3)LDF
YRM)D92
KXC)B8Y
2ZB)6X1
XWX)JCF
B3G)CG7
LHT)4NT
NNN)5LW
48W)R9S
91R)6J4
97T)BBF
1BT)KWW
B53)QL9
HBC)DB2
2D1)89S
BBL)WBG
7WK)LJP
TV1)SNJ
K5Q)L9Q
HNN)YKD
BXP)W81
64N)GLG
L9Q)M4Y
PTB)8JP
RHP)3FJ
657)PWZ
HZ7)T8S
YKD)W25
PYL)SMP
YSQ)HSJ
W84)9F8
HQS)NL2
3MC)6Y3
24K)MDD
G3D)B17
2QF)PXH
38D)FNB
614)SVH
34H)BWT
6L3)GZD
J1Y)QJ9
3XF)GG9
MHQ)25V
3PQ)L4T
57T)3W4
8KQ)614
PC9)P5K
C2Q)F4P
J37)FW2
TDC)M1F
YD4)LZV
4H5)HYC
VRY)5XG
3W4)YLR
JZ1)Q21
SBK)1XQ
RVK)6XT
9NS)LVG
JBT)612
J4R)QWT
YDT)31V
123)C78
PN3)PTM
6QM)5GN
CG7)PF8
HX4)T4H
6CK)HXR
PFT)H53
62W)FC8
KQ6)4X5
3CK)8Z5
RHS)Q7G
N13)2LT
D3J)NYJ
PFY)N44
N3F)4FF
P89)29Z
MHN)J49
S78)LCK
8DD)DR5
51H)VM3
1NF)MLL
S99)RKK
9PD)JLD
7Q5)7WK
7WK)MND
CQR)KG9
X5B)VTN
SCW)RPP
BF4)3XF
QL9)R8G
LDB)4X4
VDN)73Z
9KY)BXN
VTN)WJ1
8F4)PR2
F78)92J
7SX)GQW
GR7)22P
56B)7SX
876)HPY
HNP)V7Y
SNJ)HHH
KNR)W7S
HT2)T9W
PC2)B9Y
6VJ)HNP
4TS)32D
7FB)TZ5
5BQ)PRT
PRT)97T
G44)9DX
THR)81Z
25P)MCD
Z9L)R92
V1P)L1D
DSZ)TVC
VKV)TQ4
4LM)YM4
T8S)6N6
HPP)WV4
99X)8YW
B9P)HDV
T2Q)TNM
JVG)7XG
QGH)KTD
DBX)VNZ
DFM)RSW
29D)GYC
LYS)38D
MKK)WXZ
5B5)MQ5
BPX)2NW
5LR)PYY
VXL)6HL)";

constexpr char input7[] =
    "3,8,1001,8,10,8,105,1,0,0,21,34,47,72,93,110,191,272,353,434,99999,3,9,102,3,9,9,1001,9,3,9,4,9,99,3,9,102,4,9,9,1001,9,4,9,4,9,99,3,9,101,3,9,"
    "9,1002,9,3,9,1001,9,2,9,1002,9,2,9,101,4,9,9,4,9,99,3,9,1002,9,3,9,101,5,9,9,102,4,9,9,1001,9,4,9,4,9,99,3,9,101,3,9,9,102,4,9,9,1001,9,3,9,4,9,"
    "99,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,"
    "9,4,9,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,99,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,"
    "1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,101,2,9,9,4,9,99,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,"
    "4,9,3,9,101,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,102,2,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,99,3,9,"
    "1002,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,2,9,4,"
    "9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,99,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,1,"
    "9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,101,1,9,9,4,9,3,9,1002,9,2,9,4,9,99";

constexpr char input8[] =
    "202201222022222222222222210222222222221222220202222222022222222222222221222200221022222222222220222222220220202221222222222222222221222221222212"
    "022202202220222222222222222222221220222222220222222212222222022222222222222222222220220122222222222220222222221220212221222222222222222221222221"
    "222202122222212211222022222222222222212220222222222222221212222222022222222222222222222221221122222222222221222222202220222220222222222222222221"
    "222220222212022222222220222022222222222202221220222222222222220202222222022222222222222221222202222022222222222222222222200222222221222222222222"
    "221222222222222222222202212220222022222222222212220220222222221222221202222222222222222222222222222202221222222222222221222222202221202221222222"
    "222222222220222220222212122222212212222222202222222200220222222222221222222222222222122222222222222222222210221022222222202221222222211220202222"
    "222222222222220222222222222222222202222200222022212222222212202221222222222222221212222222022222222222222220222211220222222222212220222222212222"
    "212220222222222222222220222220222222022202202211222022222222222221221221202222222222222202222222222222222222222220222211222122222222222221222212"
    "220222212221222222222222222221222211222212122222202210222122202222222212211220202222220222221202222222122222222222222220222221221222222222222222"
    "222212200220222222222222222222221220222202222212122202202221222222202222222222211222222222220222222202222222122222222222222221222212221122222222"
    "202220222202201222212220222222222222221220222212222222022222222200222122212222222200212220212222220222220222222222022222222022222220222202220222"
    "222222212221222212211220202220222222222222220221222200222222022222212200222022210222222211222221212222220222220212022222022222222222222222222220"
    "220022222222222220222212221221212220222222222222222221222212222212222212202211222222211222222200202220212222221222221202022222222222222022222221"
    "222212222022222222202220222202221222212220222222222222222222222200222212222212212220222222221222222210220222222222221222221202022222022222222222"
    "222222222220222222222222212222222212220220212222222222222222221222222221222212222202222221122122211222222211221220222222222222221202122222222222"
    "222122222221222222221122222222212222222222212221212222222222222222221220222221222222022222212211122222220222222210212222202222220222221222022222"
    "022222222022222222222220222122222222212220222212201220222222222222222222222220222202222202122212212221222122201222222220222220202222220222222212"
    "122222122222222122222220222211221022212222222221222202222222202220222222222222220221222200222212222222212211222222221222222202200222222222222202"
    "220222022222122222222022222221222202222122222222222221222202212222222220222222222222220222222211222222222202222210222122200222222212201220202222"
    "220202221212122222222222222222222221222222220222202222222220222222212222222221222222222222222222222220222222222222212210022022202222222221222220"
    "202222221202221202222222122222222122222220222201221122222222202222222222221220212221222222222222222220222200222202222222212201122222220222222221"
    "222222212222222212220222022222022222222022222222222201221122212222202221222212202221212222222222222222221222222211222202122212222201222222202222"
    "222212200222200222221202222222022222022222222222022221222220222222212222222222222202222221212222222222222222222222222212222212022212222222122022"
    "221222222210221200220222220222220202222222222222222122122222222220222022222222202222222222200222212222222222222222210221222221222222222222202221"
    "022122220222222211212201220222222022220212022222022222220222022220222210221022202222222221222212212220212221220222222222212221222200222202122222"
    "212211222122210222222200221212201221220112220212022202222222221022022220222210221122202222212220222212211220202222220222222222201221222221222212"
    "222202222221122222222222222210220201220222221112222212022222022222220222222222222201221122212222202222222222211221222222221222222222221222222200"
    "222202022222222202022122202222222221221202202221220202221222222212122222221222022221220222221022202222202221222222221220202221220222222222202222"
    "222221222222122202212202122022220222222210200202202222220122222212122202022222221220222220221201222122212222222222222212211220202221222222222222"
    "200220222211222222222210222202022122201222222220211220201220221202220222022202222222220020122222222220220222212222222222222202212221212221222222"
    "222222222222222220220222122222212212122122222222222222201202200221221002221212222222222222221221122220222221221122202222202221222222222221222222"
    "220222222222200220222211222222222221202200222222211222222222212212222221221112221102222222122222222020122220221221221022222222202220222222210221"
    "212220221222222222210222222221220202022211202222222022202222222222202221220221221122222012022202222222221222222222220220220122202222222220222222"
    "202222202222221222222222210222222221221202122200222201022222201222222202201221221221222012220002122222122222221121122220220222221122212222222222"
    "222202221221222221222222222222221221222212221202022222222211022022202222222220222220211222221202222002222212022222220021122222221201221222212222"
    "212220222222201222212221221222022222220222222221221202222222222220022122222222222211200211200220220202220002222212122222222022222222222210221022"
    "202222202220222212212221222220222222022222210221222200221202122212222202122122211222222202211221221222221102211222222212122222221120122221222200"
    "220122202222202221222202221222222222220222222222220220222201221202022220222222022222222022222221201210200222220212201212122212122222221121022222"
    "220210222222212222212222222212210220222220221222222222211221222211120202222220212202222122202222222200220202200022221222202122022212022222221222"
    "222222221210221022212222202221222202211222202221021222222222220222222201120212022210212212022222201022222200221221221020220212210212022212022222"
    "221221022222222222221122222222222221222212210221202220220222022222221220222210222212122201212200222122210222222201211212222021222002221222222212"
    "122222220022122220221221220222212220222221222202200120222222022222222222201220222210220222222220212200022122202222222202201201200122221022212202"
    "112212022222220020022220221222222122212220212222222202200021202220121222022222212222212221121212022202222212022222201222222212210201222220221122"
    "211012022222122222221121222220220201221122202222202222222222200021222220021222222222220222212212120202022201212200222122202122222210221210210220"
    "222002201012022202122222220021022222220200222022212222202221222212200121222220022222022222222221222210022212122222212212122222211222222212200201"
    "200021220012211202022202022222222122122222220220222222222220212221222202212020202222222222222222200222212222120222022201222221022022201221222200"
    "210220211220220122200202022212122220221022222222222222222022202221212221222222201020202202121222022222210221222200022202222212222212122022220122"
    "222210210200212020222012222102002212022221220122222222220222221022202221212222222212202220212220122222022222200221222211022212222221222221022022"
    "200222222200220220221122221102222022222212122220220122022221222222222222202220212221222202221021222212221222222222211221212212122202022201202201"
    "022022201121222021200220200220222222212102212222022222222220222220222201220222212220202222222222220221212221220222222221221221222202121212122222"
    "222211022021222020222212212201211222221022220002102212122222222021022222222210220022202220222220222212220121202220022222222222221222202211122222"
    "122202222212122221221122222111212222211122220212222112222202122221221222022220221212222022222222222222222222222022212201220222022220110220212200"
    "121202122222212220022021201122222022212212222021222012210222212222122221220020222222220221222122222220222221222212221220212212121222022220000221"
    "212212021222222202222221122020200120222010202202211220220202210202202202122220220100022222222221222122222221222222222222212022222202122222222220"
    "221221212210221212122221200221122221202020222022200200211121220022212222202202122222220020022222220200221122212222212222222202201222212200022222"
    "222222102222202220020222122202220211122222220222222121202211220021220222201202122222022222221000122221220201222022222220222220222210222220222221"
    "120222022220201222112221021212022202221201022122201121222202212220221220222212201212012212122221220122022222221221222222202220202221222221222222"
    "202221220222122222120220102202122222222222201221122022200122222220211222210220222022210112112212212222221102122221220212221122202220222222222212"
    "222121202201022222022221101222122202120200122212202211022121210022222200221221200022221222220012022202112220222120022222220220220222200222222222"
    "222220201120222221021222022222000221222201222201222221222201222220211020222220202211220201220212200202202212122220221200222222221202221222202221"
    "212221222212202021222211020222122220101221012212222201222202212022122121220022222221110212211210221112222202002222012220222002222220220222220222"
    "202220212220222212200121202211121222222222220222222221121200022222210210222222201221222122002211201121220112211022202212122221222102122222220220"
    "221022212220202222222222220122222220222222222221221220202210220200022212211121222122212222222020221221200100220222212002102212122222220012022221"
    "221211220122210220222220222220221121222202020222222220011222022200020200022212122211222221210120222002222220202220222002212102002222202220222210"
    "022222221201221202221220202221222202201021222201021222022220210221002221121221122222100212122121211122222021011221221201220002201002002212202221"
    "220111022222220201221012202221202222222210221122212201220222022220110220202222122221222211112200222120212221222222202212200220221022201012102222"
    "212221222202022220211210221110221222202221222200211121222212121222022222021222102201222202222211010220222221212021222020012212221201222122222102"
    "002212212222221120022220201201220110202222212220222212202220222222021222021220210222122200121200122220010122012222210222222110112210202002200112"
    "222022112222112222220202122220010222221201200222222222222211210122202202120222221221101221022201220202022220112110002021211222222100021221201201"
    "220212212122002222012220221211022221200210220012200220212222220200221022212201022222020220210222102211021212022221200012212021201221222101202221"
    "212011222222222100112212112221221221022220210202221021221220202220222212222220222201111222220220200220212210120201122220012012022120210121222212"
    "100210222122202102211121122222202221222101222221212200222210202220202120222202221122222211102222122222220220002200221210022210220001112120202020"
    "222122012201212010222202212110202202112220220222022221001221220000220222202220220200211022202211211222222220120222112222222222022210101210211020"
    "200021222120122222211001202102202100102222102221220101022222120221221120212220222020222200211122202210001222121222222220022210121212222212012012"
    "122022222221222121200201220222201002211020102202222221222012121221211211222110212221012222220212201222212201000222022222122222102201220222122201"
    "111221020021201120222102112220221002222222201200102222222222222012221220210222200200212220112122222211211021212220210222220222212222112021222221"
    "222201211010001022210021222022120202202200201002221120002222022222221220120220110221200022200221212121222201211222212201222222022222021222002011"
    "021200122201100112110220211222222010122211222020221112210112122202202220221211121220201210212222220221222021221221220121202221202222022220101222"
    "122101221110122212000220002022221020222201012212110022221202211122012212112220221210020220210211211110200220202021222211220021222201200222122221"
    "100221012001120022022221212000222221202120222100010211021012011022212110012202202222220210122221210202202011222220012022222212201220202202010222"
    "220222211221222011220221022200000001222020222120222202010210010000211022202001012202102222220001120220220212210020220221012202220201211022202222"
    "012222022221112222202111220200222221012000012022210222222022222211020101222222002201202222122222220222220221120222222220202222112012222210202120"
    "222221220222122222001221012210122122220200120010100220222022222000120220102112002222222010202222222220220020221220020201201222221220012112222200"
    "221221212221211222022222121221102002022202022121110012010221212021222212001221202220000202210210122212022221221001122221120220200212201220202220"
    "221212222122212220222222221221001221222021020111221020011202111221220120222200201220010000020002012121022202001222222001020221101201022021201220"
    "202000222202212020212220211222221222210221212202021222121112022211201220222220221021111221211010122022202020012212121221221020120222220220220222"
    "200210002101221222221221202201122222121221111222102122121220021211001210021222202101220011102210112122021012020200112202201220222111121220222200"
    "122210200222002001220201210222212201020222221221020220122110021222000022122001120221212210220101210221120120010202020222121202102202222120020222"
    "022220102101020200012111220220221120212212000222120221010222212001020211210200020110012222221121220222002222122001121210201100212222020202221010"
    "220220000220110101002202212011220210200121202202021222222222120222222220221212201022110101202021212202220210012210112112012102121122102202222222"
    "221002221222112210112122022221112110221200210121202212111222020220002221222022021211111002022111110120222221221220212201121122101022211120000222"
    "022211222101022220102221222210210202212000021212221220212210101222122222001222222120022021111022222101120220222020220212001221201022102002022020"
    "110212021201220112122222002211112002101200202222122220202022222200222222021221101221002121020111122011021210200221202200220102111202120211201100"
    "111120100202000212221112021220200210211120201121112210021210222120222210110222202022012220122011220120200202011112012220202200122212001221121122"
    "002110102002001202221212222212022220200222122022102100212110121200201021222221111222221120002222212221221011010001001012111121221100221001200202"
    "001100121121120120200012000200222110021221111222011221010110112102120211210122212202022222101121122221112000022002202121121010111120200200221001"
    "011212220212122010122001222002001201220011022222101220212111000002002120122211210021202212112222110122001221222022222220010011002222100221202121"
    "220121212210011211202100111022022102110221220101100221200201022121210011222101221220220221212220000222001021100220222010022122202220220211101122"
    "201211222212000201211112112220202020222112212200220220201220012202000210120012022121220201200021212200211222110022010210212112222121201220221110"
    "100221212100220122101221001101001020200111121112122201221212110221112200022211111020022222220201212020222222121222000021211211212012221202210201"
    "012022101121211102121002211200202221222202020111101112201212222010100221022202020022001112022022022221202022202222122222212121021220102010120200"
    "221020221112120122212210122011221220101220000021012021102122002200220002110221221212100220000010112020120212211020212220121222200021212202112200"
    "121201002121221102001122221200121001002202020022102111210222221022101222222012220222110220222211210201102120122212221121202210021222222021002202"
    "012212021112120111020011111201112102102212202020011021111000202212221000200121102110022000220101221122110102000022212020012102001021012010002202"
    "202002010222201201112100";

constexpr char input9[] =
    "1102,34463338,34463338,63,1007,63,34463338,63,1005,63,53,1102,1,3,1000,109,988,209,12,9,1000,209,6,209,3,203,0,1008,1000,1,63,1005,63,65,1008,"
    "1000,2,63,1005,63,904,1008,1000,0,63,1005,63,58,4,25,104,0,99,4,0,104,0,99,4,17,104,0,99,0,0,1101,39,0,1004,1101,0,37,1013,1101,0,28,1001,1101,"
    "0,38,1005,1101,23,0,1008,1102,1,0,1020,1102,1,26,1010,1102,31,1,1009,1101,29,0,1015,1102,459,1,1024,1101,33,0,1007,1101,0,30,1016,1101,32,0,"
    "1002,1102,1,494,1027,1101,0,216,1029,1101,497,0,1026,1101,0,303,1022,1102,1,21,1018,1102,1,36,1006,1102,1,27,1014,1102,296,1,1023,1102,454,1,"
    "1025,1102,35,1,1003,1101,22,0,1017,1102,225,1,1028,1102,1,20,1011,1101,1,0,1021,1101,0,24,1000,1101,0,25,1019,1101,0,34,1012,109,13,21102,40,1,"
    "0,1008,1013,40,63,1005,63,203,4,187,1106,0,207,1001,64,1,64,1002,64,2,64,109,5,2106,0,10,4,213,1001,64,1,64,1105,1,225,1002,64,2,64,109,-3,1206,"
    "6,241,1001,64,1,64,1105,1,243,4,231,1002,64,2,64,109,-17,2108,30,4,63,1005,63,259,1106,0,265,4,249,1001,64,1,64,1002,64,2,64,109,14,2108,35,-9,"
    "63,1005,63,283,4,271,1105,1,287,1001,64,1,64,1002,64,2,64,109,13,2105,1,-2,1001,64,1,64,1106,0,305,4,293,1002,64,2,64,109,-28,1208,5,32,63,1005,"
    "63,327,4,311,1001,64,1,64,1106,0,327,1002,64,2,64,109,12,2102,1,0,63,1008,63,31,63,1005,63,353,4,333,1001,64,1,64,1105,1,353,1002,64,2,64,109,7,"
    "21102,41,1,-6,1008,1010,40,63,1005,63,373,1105,1,379,4,359,1001,64,1,64,1002,64,2,64,109,-4,2102,1,-6,63,1008,63,35,63,1005,63,403,1001,64,1,64,"
    "1105,1,405,4,385,1002,64,2,64,109,11,21107,42,43,-4,1005,1019,427,4,411,1001,64,1,64,1105,1,427,1002,64,2,64,109,-10,1206,7,445,4,433,1001,64,1,"
    "64,1105,1,445,1002,64,2,64,109,10,2105,1,1,4,451,1105,1,463,1001,64,1,64,1002,64,2,64,109,-14,21108,43,42,4,1005,1013,479,1106,0,485,4,469,1001,"
    "64,1,64,1002,64,2,64,109,12,2106,0,6,1106,0,503,4,491,1001,64,1,64,1002,64,2,64,109,-10,2107,30,-2,63,1005,63,521,4,509,1106,0,525,1001,64,1,64,"
    "1002,64,2,64,109,-7,2101,0,-4,63,1008,63,26,63,1005,63,549,1001,64,1,64,1106,0,551,4,531,1002,64,2,64,109,13,21107,44,43,-3,1005,1014,571,1001,"
    "64,1,64,1105,1,573,4,557,1002,64,2,64,109,-6,21108,45,45,1,1005,1012,591,4,579,1106,0,595,1001,64,1,64,1002,64,2,64,109,8,1205,2,609,4,601,1106,"
    "0,613,1001,64,1,64,1002,64,2,64,109,-11,1208,-6,34,63,1005,63,629,1106,0,635,4,619,1001,64,1,64,1002,64,2,64,109,-15,2107,33,9,63,1005,63,651,"
    "1106,0,657,4,641,1001,64,1,64,1002,64,2,64,109,9,1207,2,38,63,1005,63,677,1001,64,1,64,1106,0,679,4,663,1002,64,2,64,109,8,21101,46,0,0,1008,"
    "1010,45,63,1005,63,703,1001,64,1,64,1106,0,705,4,685,1002,64,2,64,109,-5,1201,-3,0,63,1008,63,32,63,1005,63,727,4,711,1106,0,731,1001,64,1,64,"
    "1002,64,2,64,109,-6,1207,8,34,63,1005,63,753,4,737,1001,64,1,64,1106,0,753,1002,64,2,64,109,29,1205,-8,765,1106,0,771,4,759,1001,64,1,64,1002,"
    "64,2,64,109,-18,1202,-6,1,63,1008,63,39,63,1005,63,797,4,777,1001,64,1,64,1106,0,797,1002,64,2,64,109,8,21101,47,0,0,1008,1018,47,63,1005,63,"
    "823,4,803,1001,64,1,64,1105,1,823,1002,64,2,64,109,-12,2101,0,-3,63,1008,63,35,63,1005,63,845,4,829,1106,0,849,1001,64,1,64,1002,64,2,64,109,-9,"
    "1201,5,0,63,1008,63,30,63,1005,63,869,1105,1,875,4,855,1001,64,1,64,1002,64,2,64,109,8,1202,-2,1,63,1008,63,34,63,1005,63,899,1001,64,1,64,1105,"
    "1,901,4,881,4,64,99,21101,27,0,1,21101,0,915,0,1105,1,922,21201,1,45467,1,204,1,99,109,3,1207,-2,3,63,1005,63,964,21201,-2,-1,1,21101,942,0,0,"
    "1106,0,922,21201,1,0,-1,21201,-2,-3,1,21102,1,957,0,1105,1,922,22201,1,-1,-2,1105,1,968,22101,0,-2,-2,109,-3,2106,0,0";

constexpr char input10[] = R"(#.....#...#.........###.#........#..
....#......###..#.#.###....#......##
......#..###.......#.#.#.#..#.......
......#......#.#....#.##....##.#.#.#
...###.#.#.......#..#...............
....##...#..#....##....#...#.#......
..##...#.###.....##....#.#..##.##...
..##....#.#......#.#...#.#...#.#....
.#.##..##......##..#...#.....##...##
.......##.....#.....##..#..#..#.....
..#..#...#......#..##...#.#...#...##
......##.##.#.#.###....#.#..#......#
#..#.#...#.....#...#...####.#..#...#
...##...##.#..#.....####.#....##....
.#....###.#...#....#..#......#......
.##.#.#...#....##......#.....##...##
.....#....###...#.....#....#........
...#...#....##..#.#......#.#.#......
.#..###............#.#..#...####.##.
.#.###..#.....#......#..###....##..#
#......#.#.#.#.#.#...#.#.#....##....
.#.....#.....#...##.#......#.#...#..
...##..###.........##.........#.....
..#.#..#.#...#.....#.....#...###.#..
.#..........#.......#....#..........
...##..#..#...#..#...#......####....
.#..#...##.##..##..###......#.......
.##.....#.......#..#...#..#.......#.
#.#.#..#..##..#..............#....##
..#....##......##.....#...#...##....
.##..##..#.#..#.................####
##.......#..#.#..##..#...#..........
#..##...#.##.#.#.........#..#..#....
.....#...#...#.#......#....#........
....#......###.#..#......##.....#..#
#..#...##.........#.....##.....#....)";

constexpr char input11[] =
    "3,8,1005,8,309,1106,0,11,0,0,0,104,1,104,0,3,8,102,-1,8,10,101,1,10,10,4,10,1008,8,1,10,4,10,1001,8,0,29,3,8,102,-1,8,10,101,1,10,10,4,10,1008,"
    "8,0,10,4,10,102,1,8,51,3,8,102,-1,8,10,1001,10,1,10,4,10,108,0,8,10,4,10,1002,8,1,72,1,1104,8,10,2,1105,15,10,2,1106,0,10,3,8,1002,8,-1,10,1001,"
    "10,1,10,4,10,1008,8,1,10,4,10,101,0,8,107,3,8,102,-1,8,10,1001,10,1,10,4,10,108,1,8,10,4,10,101,0,8,128,2,6,8,10,3,8,102,-1,8,10,101,1,10,10,4,"
    "10,1008,8,0,10,4,10,102,1,8,155,1006,0,96,2,108,10,10,1,101,4,10,3,8,1002,8,-1,10,101,1,10,10,4,10,1008,8,0,10,4,10,1002,8,1,188,2,1,5,10,3,8,"
    "102,-1,8,10,101,1,10,10,4,10,1008,8,0,10,4,10,102,1,8,214,2,6,18,10,1006,0,78,1,105,1,10,3,8,1002,8,-1,10,1001,10,1,10,4,10,1008,8,1,10,4,10,"
    "102,1,8,247,2,103,8,10,2,1002,10,10,2,106,17,10,1,1006,15,10,3,8,102,-1,8,10,101,1,10,10,4,10,1008,8,1,10,4,10,101,0,8,285,1,1101,18,10,101,1,9,"
    "9,1007,9,992,10,1005,10,15,99,109,631,104,0,104,1,21102,387507921664,1,1,21102,1,326,0,1106,0,430,21102,932826591260,1,1,21102,337,1,0,1106,0,"
    "430,3,10,104,0,104,1,3,10,104,0,104,0,3,10,104,0,104,1,3,10,104,0,104,1,3,10,104,0,104,0,3,10,104,0,104,1,21101,206400850983,0,1,21101,0,384,0,"
    "1105,1,430,21102,3224464603,1,1,21102,395,1,0,1106,0,430,3,10,104,0,104,0,3,10,104,0,104,0,21102,838433657700,1,1,21102,418,1,0,1106,0,430,"
    "21101,825012007272,0,1,21101,429,0,0,1106,0,430,99,109,2,21202,-1,1,1,21101,40,0,2,21101,461,0,3,21102,1,451,0,1105,1,494,109,-2,2105,1,0,0,1,0,"
    "0,1,109,2,3,10,204,-1,1001,456,457,472,4,0,1001,456,1,456,108,4,456,10,1006,10,488,1102,1,0,456,109,-2,2106,0,0,0,109,4,1202,-1,1,493,1207,-3,0,"
    "10,1006,10,511,21101,0,0,-3,21202,-3,1,1,21201,-2,0,2,21102,1,1,3,21102,1,530,0,1106,0,535,109,-4,2106,0,0,109,5,1207,-3,1,10,1006,10,558,2207,-"
    "4,-2,10,1006,10,558,22101,0,-4,-4,1106,0,626,22102,1,-4,1,21201,-3,-1,2,21202,-2,2,3,21101,0,577,0,1106,0,535,22102,1,1,-4,21101,1,0,-1,2207,-4,"
    "-2,10,1006,10,596,21102,0,1,-1,22202,-2,-1,-2,2107,0,-3,10,1006,10,618,21201,-1,0,1,21102,618,1,0,105,1,493,21202,-2,-1,-2,22201,-4,-2,-4,109,-"
    "5,2105,1,0";

constexpr char input12[] = R"(<x=0, y=6, z=1>
<x=4, y=4, z=19>
<x=-11, y=1, z=8>
<x=2, y=19, z=15>)";

constexpr char input13[] =
    "1,380,379,385,1008,2639,310356,381,1005,381,12,99,109,2640,1101,0,0,383,1101,0,0,382,20102,1,382,1,21002,383,1,2,21101,0,37,0,1105,1,578,4,382,"
    "4,383,204,1,1001,382,1,382,1007,382,40,381,1005,381,22,1001,383,1,383,1007,383,25,381,1005,381,18,1006,385,69,99,104,-1,104,0,4,386,3,384,1007,"
    "384,0,381,1005,381,94,107,0,384,381,1005,381,108,1106,0,161,107,1,392,381,1006,381,161,1101,-1,0,384,1106,0,119,1007,392,38,381,1006,381,161,"
    "1102,1,1,384,21002,392,1,1,21101,23,0,2,21101,0,0,3,21102,138,1,0,1105,1,549,1,392,384,392,20102,1,392,1,21102,1,23,2,21102,1,3,3,21102,161,1,0,"
    "1106,0,549,1101,0,0,384,20001,388,390,1,21002,389,1,2,21101,180,0,0,1105,1,578,1206,1,213,1208,1,2,381,1006,381,205,20001,388,390,1,21001,389,0,"
    "2,21102,1,205,0,1106,0,393,1002,390,-1,390,1102,1,1,384,20102,1,388,1,20001,389,391,2,21102,228,1,0,1106,0,578,1206,1,261,1208,1,2,381,1006,381,"
    "253,21001,388,0,1,20001,389,391,2,21102,253,1,0,1105,1,393,1002,391,-1,391,1101,0,1,384,1005,384,161,20001,388,390,1,20001,389,391,2,21101,0,"
    "279,0,1105,1,578,1206,1,316,1208,1,2,381,1006,381,304,20001,388,390,1,20001,389,391,2,21101,0,304,0,1105,1,393,1002,390,-1,390,1002,391,-1,391,"
    "1101,0,1,384,1005,384,161,20102,1,388,1,20101,0,389,2,21101,0,0,3,21101,0,338,0,1106,0,549,1,388,390,388,1,389,391,389,20101,0,388,1,21001,389,"
    "0,2,21102,4,1,3,21101,0,365,0,1105,1,549,1007,389,24,381,1005,381,75,104,-1,104,0,104,0,99,0,1,0,0,0,0,0,0,348,18,20,1,1,20,109,3,21201,-2,0,1,"
    "21202,-1,1,2,21102,1,0,3,21101,414,0,0,1105,1,549,21202,-2,1,1,21201,-1,0,2,21101,429,0,0,1105,1,601,1201,1,0,435,1,386,0,386,104,-1,104,0,4,"
    "386,1001,387,-1,387,1005,387,451,99,109,-3,2106,0,0,109,8,22202,-7,-6,-3,22201,-3,-5,-3,21202,-4,64,-2,2207,-3,-2,381,1005,381,492,21202,-2,-1,-"
    "1,22201,-3,-1,-3,2207,-3,-2,381,1006,381,481,21202,-4,8,-2,2207,-3,-2,381,1005,381,518,21202,-2,-1,-1,22201,-3,-1,-3,2207,-3,-2,381,1006,381,"
    "507,2207,-3,-4,381,1005,381,540,21202,-4,-1,-1,22201,-3,-1,-3,2207,-3,-4,381,1006,381,529,22101,0,-3,-7,109,-8,2106,0,0,109,4,1202,-2,40,566,"
    "201,-3,566,566,101,639,566,566,1201,-1,0,0,204,-3,204,-2,204,-1,109,-4,2105,1,0,109,3,1202,-1,40,593,201,-2,593,593,101,639,593,593,21001,0,0,-"
    "2,109,-3,2105,1,0,109,3,22102,25,-2,1,22201,1,-1,1,21101,0,503,2,21101,366,0,3,21102,1,1000,4,21101,630,0,0,1105,1,456,21201,1,1639,-2,109,-3,"
    "2106,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"
    "0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,2,0,2,2,2,0,0,0,2,0,0,2,0,2,2,2,0,0,2,0,0,2,0,2,2,2,2,0,2,2,2,0,0,0,1,1,0,0,0,2,2,0,2,2,2,2,0,2,0,2,2,2,2,2,"
    "0,2,0,0,0,2,2,2,2,2,2,0,0,0,2,0,2,2,0,0,1,1,0,0,2,2,0,2,0,0,2,2,0,2,2,2,0,2,0,0,0,0,2,2,2,2,0,2,2,0,2,0,0,0,0,2,2,2,2,0,1,1,0,2,2,0,0,0,0,2,2,2,"
    "0,2,2,2,0,2,0,0,2,2,2,2,0,2,2,2,0,2,0,2,2,0,0,0,2,2,2,0,1,1,0,2,2,2,2,2,2,2,0,2,0,2,0,0,2,0,2,0,2,0,2,0,2,2,0,2,0,0,0,2,2,0,2,2,2,0,0,0,1,1,0,0,"
    "0,2,0,0,2,0,2,0,0,2,0,0,0,2,2,0,2,0,0,0,0,0,2,2,0,2,0,2,2,2,0,2,0,0,2,0,1,1,0,2,0,2,2,2,0,0,2,2,0,2,0,2,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,2,0,2,0,0,"
    "0,2,2,0,1,1,0,0,2,2,2,0,0,2,2,2,2,0,0,2,0,0,2,2,2,2,2,2,0,2,0,0,0,2,2,0,2,2,2,2,0,2,0,0,1,1,0,0,2,2,0,0,2,2,0,2,2,0,0,2,2,2,0,0,0,0,2,2,0,2,0,2,"
    "0,2,0,0,0,0,0,0,0,2,2,0,1,1,0,0,2,0,2,2,2,2,2,2,0,0,2,2,2,0,0,2,2,2,2,2,0,0,2,0,0,2,0,2,0,2,2,0,0,0,2,0,1,1,0,2,0,2,0,2,0,2,2,2,0,0,0,0,2,0,2,0,"
    "2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,2,2,0,1,1,0,2,2,2,0,2,2,2,2,2,0,0,2,2,2,0,0,0,0,0,2,0,2,0,2,2,0,2,0,0,0,0,2,2,2,2,0,0,1,1,0,2,2,2,0,2,0,2,0,0,"
    "0,0,2,0,0,2,0,0,2,2,2,2,2,0,2,0,2,0,2,2,2,0,0,2,0,0,2,0,1,1,0,0,2,2,2,2,0,2,2,2,2,0,2,0,2,2,0,2,0,2,2,0,0,2,2,2,2,2,0,2,2,2,2,2,0,2,2,0,1,1,0,2,"
    "0,2,2,2,0,0,2,0,2,2,0,2,2,0,2,0,0,2,2,0,2,2,0,2,2,0,2,2,0,2,2,2,0,2,0,0,1,1,0,2,0,0,2,2,0,0,0,0,2,0,0,2,0,2,2,2,0,2,2,0,2,2,2,0,2,0,2,0,2,0,0,2,"
    "2,0,0,0,1,1,0,2,2,2,2,2,2,0,2,2,0,2,2,2,0,2,2,2,2,2,0,2,0,2,0,0,2,2,2,2,2,2,0,0,0,2,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"
    "0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"
    "0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,"
    "0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,24,35,"
    "13,44,44,95,83,45,69,64,58,57,22,91,79,21,65,90,94,24,82,6,96,96,64,21,91,4,36,76,6,74,41,72,32,87,50,48,47,93,86,73,24,78,50,10,95,14,50,78,6,"
    "90,98,26,68,75,40,73,80,89,1,41,68,42,47,58,32,23,48,11,83,74,68,41,55,89,46,8,27,5,3,81,42,88,49,51,55,91,22,93,13,12,10,87,42,90,35,88,12,94,"
    "79,76,89,39,71,69,32,5,72,45,12,79,57,35,60,46,28,34,79,3,97,32,52,77,66,26,55,8,89,2,76,20,49,64,72,50,15,21,22,63,19,22,44,11,44,36,4,77,24,"
    "25,29,8,31,27,68,91,90,89,18,53,67,92,68,59,7,56,2,88,83,82,83,5,73,19,53,81,85,65,93,10,21,46,69,90,32,17,37,31,69,96,93,10,98,32,86,73,91,95,"
    "13,15,83,72,10,4,52,64,35,52,42,55,4,76,13,39,54,31,51,78,62,40,14,11,81,34,93,97,47,67,26,46,86,80,69,6,8,56,12,80,88,49,20,79,40,7,54,63,15,"
    "46,64,59,74,28,11,48,27,41,20,27,29,70,73,46,18,21,48,26,42,63,7,80,54,8,43,31,3,39,10,30,7,98,87,33,62,81,61,31,64,27,94,38,42,39,55,9,61,38,"
    "76,8,48,13,94,8,85,23,72,84,6,60,18,25,30,64,37,97,59,71,16,83,83,18,92,53,39,17,73,39,37,30,9,2,87,32,23,56,11,24,1,84,82,5,8,60,55,44,57,43,"
    "14,88,72,51,83,20,3,70,33,33,1,6,86,17,4,77,69,33,65,93,97,66,42,23,34,96,4,25,76,46,2,34,52,5,17,87,69,15,22,3,87,80,36,1,70,43,56,64,11,47,39,"
    "5,64,1,41,54,34,95,42,17,8,68,73,45,54,84,16,83,59,27,56,75,34,44,78,70,19,25,90,52,65,58,1,72,2,70,3,26,11,69,73,74,29,8,22,2,93,18,98,16,10,"
    "62,92,44,70,69,86,53,2,43,62,45,18,22,46,87,48,21,56,36,71,91,94,84,95,28,74,64,16,44,27,35,33,41,66,9,74,3,94,78,3,47,91,66,92,10,2,6,45,57,24,"
    "83,4,56,25,24,51,77,39,36,28,20,6,27,14,25,54,15,84,5,29,16,98,21,32,94,93,5,75,67,65,89,32,16,79,71,31,89,9,5,39,12,14,34,61,9,80,1,65,59,48,"
    "48,46,60,98,1,29,98,57,17,18,76,49,93,13,28,37,88,37,46,4,19,48,10,58,37,47,13,85,23,10,48,77,68,92,62,74,63,7,21,31,20,53,87,74,9,32,80,91,70,"
    "9,95,90,37,61,60,26,22,56,26,79,65,58,88,51,7,42,43,89,90,11,10,27,19,10,76,96,34,55,36,2,67,11,25,15,96,35,27,50,78,12,8,77,76,26,49,77,60,41,"
    "14,24,3,52,52,49,25,35,45,21,98,1,61,2,32,55,86,55,48,28,15,69,97,42,85,90,58,1,75,8,91,60,26,9,70,86,16,50,95,52,90,17,54,1,98,12,25,13,26,94,"
    "47,24,23,54,54,65,65,94,61,14,58,35,72,23,98,32,4,84,36,58,38,98,59,1,6,56,1,43,56,33,31,39,64,88,60,30,41,98,17,89,7,15,76,20,43,44,60,65,94,"
    "32,71,12,67,87,38,35,56,84,31,12,33,5,42,66,87,47,21,4,52,16,74,18,10,32,97,76,68,76,59,77,92,65,6,15,32,32,14,2,64,67,14,34,3,44,39,56,60,88,"
    "56,88,1,76,14,20,67,53,98,74,88,90,67,40,41,56,27,81,58,93,41,78,31,28,12,25,28,94,20,18,41,40,79,10,96,1,64,57,90,30,83,87,71,75,73,63,48,18,"
    "10,39,96,60,87,24,54,73,96,6,7,32,26,18,20,4,42,33,63,76,14,21,74,72,3,85,59,16,43,3,22,11,29,96,8,51,32,5,35,94,84,48,58,17,37,58,98,64,63,63,"
    "96,31,24,67,29,85,34,29,63,42,68,53,10,47,61,87,33,74,6,76,71,38,52,56,69,32,4,11,44,34,67,13,2,92,55,69,31,15,21,24,7,54,71,93,64,53,67,24,61,"
    "25,90,4,95,85,15,44,32,86,11,10,3,32,26,43,18,98,89,82,19,34,30,74,24,96,14,79,46,87,22,53,66,60,91,40,75,92,66,13,33,13,29,55,69,77,34,87,49,"
    "83,57,76,42,11,53,27,42,82,28,46,91,310356";

constexpr char input14[] = R"(2 KBRD => 3 NSPQ
1 TMTNM, 5 WMZD => 4 JVBK
3 TMTNM => 8 JTPF
3 NDXL => 2 BDQP
2 VTGNT => 2 TNWR
1 ZQRBC => 2 WGDN
2 MJMC => 3 QZCZ
10 MDXVB, 3 DHTB => 1 SRLP
1 KBRD, 1 PNPW => 6 SQCB
1 KDTRS, 4 VTGNT => 7 NDXL
1 FZSJ => 1 CJPSR
6 TKMKD => 8 FTND
2 ZNBSN => 4 DNPT
16 SKWKQ, 2 FZSJ, 3 GSQL, 1 PNRC, 4 QNKZW, 4 RHZR, 10 MTJF, 1 XHPK => 3 RJQW
1 NHQW => 8 QNKZW
16 JZFCN, 9 KWQSC, 1 JGTR => 7 TMTNM
2 PNRC => 7 LCZD
1 NLSNC, 14 SXKC, 2 DHTB => 1 ZQRBC
1 MXGQ, 2 KWQPL => 3 FZSJ
6 DWKLT, 1 VHNXW, 3 NSPQ => 1 BQXNW
23 KDTRS => 1 XHPK
1 PFBF, 3 KBLHZ => 3 MBGWZ
5 NSPQ => 3 TPJP
27 SRLP, 12 KWQSC, 14 ZNBSN, 33 HQTPN, 3 HWFQ, 23 QZCZ, 6 ZPDN, 32 RJQW, 3 GDXG => 1 FUEL
2 NSPQ, 5 ZNBSN, 1 TPJP => 8 PFBF
1 MSCRZ => 3 ZNBSN
1 TNWR, 2 ZNBSN => 5 MDXVB
10 SQCB => 5 MXGQ
3 JVBK, 1 MTJF, 1 KBLHZ => 2 HQTPN
2 MJMC => 2 KMLKR
2 BQXNW, 1 CJPSR, 25 KWQPL => 4 PNRC
1 VHNXW, 3 KWZKV => 4 TKMKD
10 VTGNT, 4 JTPF => 9 KWZKV
168 ORE => 3 JZFCN
173 ORE => 5 KBRD
2 TNWR, 1 MBGWZ, 3 NSPQ => 8 SKWKQ
1 KWZKV, 2 MJMC, 14 SKWKQ => 9 NSTR
4 JZFCN, 13 PNPW => 2 WMZD
6 JQNGL => 6 MGFZ
1 SQCB, 4 NLSNC => 5 DHTB
5 MGFZ, 39 WGDN, 1 MBGWZ, 2 NSTR, 1 XKBND, 1 SXKC, 1 JVBK => 5 ZPDN
7 NSPQ, 6 PNPW => 7 NLSNC
3 TNWR => 9 KWQPL
9 NLSNC, 4 NDXL, 1 MDXVB => 4 MTJF
2 VTJC => 7 PNPW
2 JZFCN => 8 MSCRZ
134 ORE => 3 JGTR
3 HQTPN => 4 GSQL
154 ORE => 9 VTJC
1 KWQSC, 14 KBRD => 4 JQCZ
7 PNRC, 1 XKBND => 8 RHZR
1 JQCZ => 4 VTGNT
6 BDQP => 6 JQNGL
7 FTND => 3 XKBND
2 XHPK, 4 NHQW => 1 MJMC
1 JQCZ => 5 KDTRS
1 DNPT => 4 KBLHZ
1 KMLKR, 26 ZNBSN, 1 LCZD, 11 QNKZW, 2 SQCB, 3 FTND, 24 PNRC => 4 HWFQ
179 ORE => 6 KWQSC
2 TKMKD, 3 FZSJ => 2 SXKC
2 JTPF => 7 VHNXW
1 FTND => 7 DWKLT
13 TNWR, 2 QNKZW, 6 SQCB => 5 GDXG
5 JTPF, 4 ZNBSN, 8 WMZD => 8 NHQW)";

constexpr char input15[] =
    "3,1033,1008,1033,1,1032,1005,1032,31,1008,1033,2,1032,1005,1032,58,1008,1033,3,1032,1005,1032,81,1008,1033,4,1032,1005,1032,104,99,1002,1034,1,"
    "1039,1002,1036,1,1041,1001,1035,-1,1040,1008,1038,0,1043,102,-1,1043,1032,1,1037,1032,1042,1105,1,124,1001,1034,0,1039,101,0,1036,1041,1001,"
    "1035,1,1040,1008,1038,0,1043,1,1037,1038,1042,1105,1,124,1001,1034,-1,1039,1008,1036,0,1041,101,0,1035,1040,1001,1038,0,1043,101,0,1037,1042,"
    "1105,1,124,1001,1034,1,1039,1008,1036,0,1041,1001,1035,0,1040,1002,1038,1,1043,1001,1037,0,1042,1006,1039,217,1006,1040,217,1008,1039,40,1032,"
    "1005,1032,217,1008,1040,40,1032,1005,1032,217,1008,1039,37,1032,1006,1032,165,1008,1040,39,1032,1006,1032,165,1102,2,1,1044,1105,1,224,2,1041,"
    "1043,1032,1006,1032,179,1101,0,1,1044,1106,0,224,1,1041,1043,1032,1006,1032,217,1,1042,1043,1032,1001,1032,-1,1032,1002,1032,39,1032,1,1032,"
    "1039,1032,101,-1,1032,1032,101,252,1032,211,1007,0,37,1044,1106,0,224,1102,0,1,1044,1105,1,224,1006,1044,247,1002,1039,1,1034,1001,1040,0,1035,"
    "1002,1041,1,1036,102,1,1043,1038,1002,1042,1,1037,4,1044,1105,1,0,2,32,78,22,32,29,53,14,61,46,21,16,34,19,73,25,76,17,97,20,4,63,23,46,15,13,"
    "75,30,58,28,29,82,23,32,11,22,16,82,2,57,24,31,48,51,4,52,25,92,15,78,78,55,32,46,5,31,88,21,74,29,47,89,34,80,58,14,33,4,69,74,33,70,60,7,39,"
    "29,68,12,1,11,64,17,75,4,52,11,47,24,71,23,99,83,28,17,56,94,33,8,90,9,83,7,62,15,77,45,49,5,53,36,67,18,82,93,22,53,9,20,20,60,90,22,25,48,15,"
    "27,68,12,27,13,50,25,92,73,35,81,15,1,48,22,12,35,38,1,36,44,12,82,30,92,22,71,31,39,20,43,34,46,36,24,67,72,13,85,45,18,68,64,20,40,2,67,25,15,"
    "33,40,53,48,32,59,13,57,28,61,26,15,88,21,42,15,95,34,74,32,7,82,63,22,95,22,83,22,20,25,11,81,88,94,31,9,50,26,76,78,34,88,19,68,72,7,85,14,54,"
    "80,5,5,45,24,24,91,22,34,39,32,22,11,15,87,57,35,83,86,51,23,71,29,13,23,59,51,36,46,33,27,99,4,13,59,14,55,88,89,29,22,97,46,40,2,17,48,93,9,"
    "40,35,94,6,71,34,14,2,39,29,36,5,55,72,31,22,87,4,50,27,92,36,88,20,82,79,21,35,67,57,23,48,6,15,65,10,69,12,29,3,8,51,56,90,29,88,59,28,40,89,"
    "18,93,83,2,66,46,22,50,30,86,3,49,55,22,33,97,27,51,15,7,26,57,36,98,3,64,35,84,90,16,88,3,7,98,94,13,1,13,71,88,36,17,84,29,5,57,50,84,14,47,"
    "25,85,64,31,95,8,43,10,81,36,58,3,40,24,40,20,13,5,14,50,42,23,9,74,40,92,4,10,3,60,1,91,39,27,77,9,20,42,47,35,15,90,43,21,46,30,63,85,28,93,6,"
    "82,8,86,86,88,30,33,26,8,92,58,32,20,1,40,72,79,49,68,14,73,6,2,99,9,5,12,47,43,14,29,66,8,31,12,97,8,69,32,63,31,96,23,32,24,60,69,74,15,24,6,"
    "76,39,14,33,89,36,6,63,21,10,95,95,32,45,41,8,76,82,14,78,15,79,72,71,34,39,27,56,27,48,28,94,21,30,25,27,53,1,81,26,24,80,55,27,51,2,93,15,80,"
    "12,28,36,56,3,7,77,34,90,49,44,24,35,99,63,11,88,93,28,75,21,62,57,8,44,10,57,9,61,4,43,3,21,20,41,95,13,6,98,16,93,70,98,64,27,35,49,12,18,23,"
    "17,68,5,11,13,61,79,30,87,53,11,11,26,80,23,55,92,46,31,70,13,76,87,29,6,91,19,90,88,36,39,25,99,12,87,90,1,93,12,98,28,27,44,51,18,32,80,86,1,"
    "26,1,19,99,83,18,2,58,29,68,3,77,82,6,55,63,56,2,61,4,90,21,22,71,30,36,51,64,32,44,52,9,51,80,93,9,71,20,41,98,21,12,61,80,10,80,33,92,80,78,8,"
    "29,9,70,4,76,24,13,92,5,26,80,88,72,3,3,49,73,27,98,15,46,30,73,17,94,30,78,5,75,16,2,57,3,96,15,47,36,31,53,39,34,44,26,96,41,68,9,81,20,40,25,"
    "76,55,9,67,3,28,18,63,1,31,31,87,22,20,67,10,2,77,20,74,28,79,34,52,91,51,24,47,13,58,9,61,10,77,25,72,17,45,8,51,16,72,3,69,80,79,6,53,48,83,"
    "34,63,86,42,19,42,0,0,21,21,1,10,1,0,0,0,0,0,0";

constexpr char input16[] =
    "597080728435568581452305221802237456945447456223360454765064379149869233722602748013160913451261415495222858394027018238846900044976741326155208"
    "718399430840409799401981428928253261105130415810643885834889308913809424853077326664853845237058527906838098120737387580551152930906352338872060"
    "409610427599969728448108914206921173533336659077107090206984870198056697825980047994212263563728854644808181967862564729447610362048975489776478"
    "808372842324448632309585760950918242264265011197485186407095922255297078919692954410262843041376067355062946040605491028249777207762724637383491"
    "54440565501914642111802044575388635071779775767726626682303495430936326809";

constexpr char input17[] =
    "1,330,331,332,109,3300,1102,1182,1,15,1101,1455,0,24,1002,0,1,570,1006,570,36,101,0,571,0,1001,570,-1,570,1001,24,1,24,1106,0,18,1008,571,0,571,"
    "1001,15,1,15,1008,15,1455,570,1006,570,14,21102,58,1,0,1106,0,786,1006,332,62,99,21101,333,0,1,21102,1,73,0,1105,1,579,1101,0,0,572,1101,0,0,"
    "573,3,574,101,1,573,573,1007,574,65,570,1005,570,151,107,67,574,570,1005,570,151,1001,574,-64,574,1002,574,-1,574,1001,572,1,572,1007,572,11,"
    "570,1006,570,165,101,1182,572,127,102,1,574,0,3,574,101,1,573,573,1008,574,10,570,1005,570,189,1008,574,44,570,1006,570,158,1106,0,81,21101,0,"
    "340,1,1105,1,177,21101,477,0,1,1105,1,177,21102,1,514,1,21101,176,0,0,1106,0,579,99,21101,0,184,0,1105,1,579,4,574,104,10,99,1007,573,22,570,"
    "1006,570,165,101,0,572,1182,21101,0,375,1,21102,211,1,0,1106,0,579,21101,1182,11,1,21102,222,1,0,1106,0,979,21102,1,388,1,21102,1,233,0,1106,0,"
    "579,21101,1182,22,1,21102,1,244,0,1106,0,979,21101,0,401,1,21102,255,1,0,1106,0,579,21101,1182,33,1,21101,0,266,0,1106,0,979,21102,1,414,1,"
    "21101,277,0,0,1106,0,579,3,575,1008,575,89,570,1008,575,121,575,1,575,570,575,3,574,1008,574,10,570,1006,570,291,104,10,21101,1182,0,1,21101,"
    "313,0,0,1105,1,622,1005,575,327,1101,0,1,575,21102,327,1,0,1106,0,786,4,438,99,0,1,1,6,77,97,105,110,58,10,33,10,69,120,112,101,99,116,101,100,"
    "32,102,117,110,99,116,105,111,110,32,110,97,109,101,32,98,117,116,32,103,111,116,58,32,0,12,70,117,110,99,116,105,111,110,32,65,58,10,12,70,117,"
    "110,99,116,105,111,110,32,66,58,10,12,70,117,110,99,116,105,111,110,32,67,58,10,23,67,111,110,116,105,110,117,111,117,115,32,118,105,100,101,"
    "111,32,102,101,101,100,63,10,0,37,10,69,120,112,101,99,116,101,100,32,82,44,32,76,44,32,111,114,32,100,105,115,116,97,110,99,101,32,98,117,116,"
    "32,103,111,116,58,32,36,10,69,120,112,101,99,116,101,100,32,99,111,109,109,97,32,111,114,32,110,101,119,108,105,110,101,32,98,117,116,32,103,"
    "111,116,58,32,43,10,68,101,102,105,110,105,116,105,111,110,115,32,109,97,121,32,98,101,32,97,116,32,109,111,115,116,32,50,48,32,99,104,97,114,"
    "97,99,116,101,114,115,33,10,94,62,118,60,0,1,0,-1,-1,0,1,0,0,0,0,0,0,1,44,2,0,109,4,2101,0,-3,587,20101,0,0,-1,22101,1,-3,-3,21102,1,0,-2,2208,-"
    "2,-1,570,1005,570,617,2201,-3,-2,609,4,0,21201,-2,1,-2,1105,1,597,109,-4,2105,1,0,109,5,2101,0,-4,630,20102,1,0,-2,22101,1,-4,-4,21101,0,0,-3,"
    "2208,-3,-2,570,1005,570,781,2201,-4,-3,652,21002,0,1,-1,1208,-1,-4,570,1005,570,709,1208,-1,-5,570,1005,570,734,1207,-1,0,570,1005,570,759,1206,"
    "-1,774,1001,578,562,684,1,0,576,576,1001,578,566,692,1,0,577,577,21101,0,702,0,1105,1,786,21201,-1,-1,-1,1105,1,676,1001,578,1,578,1008,578,4,"
    "570,1006,570,724,1001,578,-4,578,21102,1,731,0,1105,1,786,1106,0,774,1001,578,-1,578,1008,578,-1,570,1006,570,749,1001,578,4,578,21101,0,756,0,"
    "1105,1,786,1105,1,774,21202,-1,-11,1,22101,1182,1,1,21102,1,774,0,1105,1,622,21201,-3,1,-3,1105,1,640,109,-5,2106,0,0,109,7,1005,575,802,20101,"
    "0,576,-6,21001,577,0,-5,1105,1,814,21102,0,1,-1,21102,1,0,-5,21101,0,0,-6,20208,-6,576,-2,208,-5,577,570,22002,570,-2,-2,21202,-5,45,-3,22201,-"
    "6,-3,-3,22101,1455,-3,-3,1202,-3,1,843,1005,0,863,21202,-2,42,-4,22101,46,-4,-4,1206,-2,924,21101,1,0,-1,1106,0,924,1205,-2,873,21101,35,0,-4,"
    "1105,1,924,2101,0,-3,878,1008,0,1,570,1006,570,916,1001,374,1,374,2101,0,-3,895,1102,2,1,0,1202,-3,1,902,1001,438,0,438,2202,-6,-5,570,1,570,"
    "374,570,1,570,438,438,1001,578,558,921,21001,0,0,-4,1006,575,959,204,-4,22101,1,-6,-6,1208,-6,45,570,1006,570,814,104,10,22101,1,-5,-5,1208,-5,"
    "41,570,1006,570,810,104,10,1206,-1,974,99,1206,-1,974,1102,1,1,575,21102,973,1,0,1105,1,786,99,109,-7,2106,0,0,109,6,21101,0,0,-4,21102,0,1,-3,"
    "203,-2,22101,1,-3,-3,21208,-2,82,-1,1205,-1,1030,21208,-2,76,-1,1205,-1,1037,21207,-2,48,-1,1205,-1,1124,22107,57,-2,-1,1205,-1,1124,21201,-2,-"
    "48,-2,1106,0,1041,21101,0,-4,-2,1105,1,1041,21102,1,-5,-2,21201,-4,1,-4,21207,-4,11,-1,1206,-1,1138,2201,-5,-4,1059,2102,1,-2,0,203,-2,22101,1,-"
    "3,-3,21207,-2,48,-1,1205,-1,1107,22107,57,-2,-1,1205,-1,1107,21201,-2,-48,-2,2201,-5,-4,1090,20102,10,0,-1,22201,-2,-1,-2,2201,-5,-4,1103,2102,"
    "1,-2,0,1106,0,1060,21208,-2,10,-1,1205,-1,1162,21208,-2,44,-1,1206,-1,1131,1106,0,989,21102,439,1,1,1105,1,1150,21101,477,0,1,1106,0,1150,21101,"
    "514,0,1,21102,1,1149,0,1105,1,579,99,21101,0,1157,0,1105,1,579,204,-2,104,10,99,21207,-3,22,-1,1206,-1,1138,1202,-5,1,1176,1201,-4,0,0,109,-6,"
    "2105,1,0,6,9,36,1,7,1,36,1,7,1,23,7,6,1,7,1,23,1,12,1,7,1,23,1,12,1,7,1,23,1,12,5,3,1,11,13,16,1,3,1,11,1,24,11,9,1,24,1,3,1,3,1,1,1,9,1,24,1,3,"
    "1,3,1,1,1,9,1,24,1,3,1,3,1,1,1,9,1,24,1,3,1,3,13,24,1,3,1,5,1,34,7,3,1,38,1,1,1,3,1,38,1,1,1,3,1,38,1,1,1,3,1,38,7,40,1,44,1,44,1,44,1,11,7,26,"
    "1,11,1,5,1,22,11,5,1,5,1,22,1,3,1,5,1,5,1,5,1,14,13,5,1,5,1,5,1,3,1,10,1,7,1,9,1,5,1,5,1,3,1,10,1,7,1,5,13,3,1,3,1,10,1,7,1,5,1,3,1,5,1,1,1,3,1,"
    "3,1,10,1,5,13,5,1,1,1,3,1,3,1,10,1,5,1,1,1,5,1,9,1,1,1,3,1,3,1,10,1,5,1,1,1,5,1,9,11,10,1,5,1,1,1,5,1,11,1,3,1,14,7,1,7,11,1,3,5,36,1,7,1,36,1,"
    "7,1,36,1,7,1,36,1,7,1,36,1,7,1,36,9,10";

constexpr char input18[] = R"()";

constexpr char input19[] =
    "109,424,203,1,21102,11,1,0,1105,1,282,21101,18,0,0,1106,0,259,1202,1,1,221,203,1,21101,0,31,0,1106,0,282,21102,38,1,0,1105,1,259,20101,0,23,2,"
    "22102,1,1,3,21102,1,1,1,21102,57,1,0,1105,1,303,2101,0,1,222,21002,221,1,3,20101,0,221,2,21102,1,259,1,21101,0,80,0,1105,1,225,21102,40,1,2,"
    "21101,0,91,0,1105,1,303,1201,1,0,223,20101,0,222,4,21101,0,259,3,21101,0,225,2,21101,0,225,1,21102,118,1,0,1105,1,225,21001,222,0,3,21102,1,144,"
    "2,21101,0,133,0,1105,1,303,21202,1,-1,1,22001,223,1,1,21102,148,1,0,1105,1,259,1202,1,1,223,20101,0,221,4,21001,222,0,3,21102,1,14,2,1001,132,-"
    "2,224,1002,224,2,224,1001,224,3,224,1002,132,-1,132,1,224,132,224,21001,224,1,1,21102,195,1,0,106,0,109,20207,1,223,2,20101,0,23,1,21101,0,-1,3,"
    "21102,214,1,0,1105,1,303,22101,1,1,1,204,1,99,0,0,0,0,109,5,2101,0,-4,249,22101,0,-3,1,21201,-2,0,2,22101,0,-1,3,21101,0,250,0,1105,1,225,21202,"
    "1,1,-4,109,-5,2105,1,0,109,3,22107,0,-2,-1,21202,-1,2,-1,21201,-1,-1,-1,22202,-1,-2,-2,109,-3,2106,0,0,109,3,21207,-2,0,-1,1206,-1,294,104,0,99,"
    "21202,-2,1,-2,109,-3,2106,0,0,109,5,22207,-3,-4,-1,1206,-1,346,22201,-4,-3,-4,21202,-3,-1,-1,22201,-4,-1,2,21202,2,-1,-1,22201,-4,-1,1,21202,-2,"
    "1,3,21101,343,0,0,1106,0,303,1105,1,415,22207,-2,-3,-1,1206,-1,387,22201,-3,-2,-3,21202,-2,-1,-1,22201,-3,-1,3,21202,3,-1,-1,22201,-3,-1,2,"
    "21202,-4,1,1,21102,384,1,0,1106,0,303,1105,1,415,21202,-4,-1,-4,22201,-4,-3,-4,22202,-3,-2,-2,22202,-2,-4,-4,22202,-3,-2,-3,21202,-4,-1,-2,"
    "22201,-3,-2,1,22101,0,1,-4,109,-5,2106,0,0";

constexpr char input20[] = R"(                                   H     C       O         L   Q     X   U
                                   W     N       V         H   G     H   P
  #################################.#####.#######.#########.###.#####.###.#######################################
  #...#...#.#.......#...................#.#...#.....#.#.#...#.......#...#.....#...#.......#...........#.......#.#
  ###.#.###.###.###.#####.#####.#######.#.#.#.#####.#.#.#.###.#.#.#####.#.#####.###.#.#.###.###.#####.###.#####.#
  #.......#.#.....#...#...#.#...#...#...#...#...#.#.....#.....#.#.#.....#.......#...#.#.......#.....#.#.#.#.#...#
  #.#.#.###.#####.#.#.#####.###.#.#.#.#.#.#.###.#.#####.#######.###.#.#.###.#######.#####.#####.#######.#.#.###.#
  #.#.#...#...#...#.#.........#.#.#...#.#.#.#.#.#.......#.....#...#.#.#.#...........#...#...#.#...#.......#.....#
  #######.#.#######.#.###.#.#####.###########.#.#.###.###.###.#.#####.#######.#.#####.###.###.###########.###.###
  #.........#.#...#.#.#.#.#...............#.....#...#...#...#...#.#.......#...#.#.#.#...#.#.#.#.#.....#.#.......#
  #########.#.###.###.#.#############.#########.#.#######.###.#.#.#.###.###.#.###.#.#.#####.#.#.#.#####.#.###.#.#
  #.#...#.....#.#.......#...#.#.........#...#...#...#...#.#...#.#.#...#...#.#.#...#.#...#.#.#.........#...#...#.#
  #.###.###.#.#.###.#.#####.#.###.###.#.#.###.#.#.#####.#.###.###.#.#######.###.###.#.###.#.#.###########.###.###
  #.#.#.....#.#...#.#.#...........#...#.#.....#.#...#.......#.#.........#.....#.#.........#...#.#.#.#.....#.....#
  #.#.#.###.#####.#######.###.###.###.###.#.#.###.#.###.###.#####.#.#####.###.#.#.#.#.###.#.###.#.#.#########.###
  #.....#.#.#.#.#.......#.#...#.....#...#.#.#.#...#...#.#.......#.#.#.#.....#.....#.#...#.............#.#.#.....#
  #######.#.#.#.#######.#.#######.#######.#######.#.#####.#######.###.#########.#####.#.#.#####.#.###.#.#.#.#.###
  #...........#.....#...#...#.#...#.#.#.......#...#.#.........#.#...#...#.#...#.#...#.#.#.....#.#.#.#.#...#.#.#.#
  ###########.#####.#.#######.###.#.#.###.###.###.###.#.#.#.###.#.###.###.###.#.#.###.#######.#.###.###.#####.#.#
  #...#.........#...#.#.#.....#.....#...#.#...#...#.#.#.#.#.....#.#.#.......#.....#.......#.#.#.#.#.#...#...#.#.#
  ###.###.#.#.###.#.#.#.###.#####.###.#.#.###.###.#.###########.#.#.#.#######.#.#####.#####.#####.#.###.###.#.#.#
  #.......#.#...#.#.........#.#...#.#.#.#.#.#.#.#...#.#.#.......#.#.......#.#.#.#.#.#.#.#...........#.....#.#...#
  #####.#####.###.#.#.#####.#.###.#.#.###.#.#.#.#.#.#.#.#.###.#.#.###.#.###.###.#.#.###.#####.#########.#.#.#.###
  #.....#.#.....#.#.#...#.....#...#.....#...#.#...#.....#...#.#.#.....#.#.#.............#.#...#.#.....#.#.......#
  #.#.###.#.#.#############.#####.#.###.###.###########.###.#######.###.#.#.#######.#####.#.#.#.#####.###.###.###
  #.#.#.....#...#...#...#.#...#.#...#...#.......#.....#.#.......#...#...#.........#.....#.#.#.#.....#...#.#.....#
  ###########.###.#####.#.#.###.#.###.###.#.#.###.#.###.#.#######.#.###.###.###.#.###.###.#.###.#####.#######.###
  #.#.....#.#.....#.#.#.#...#.....#.....#.#.#.#.#.#.#...#.#.#.#.#.#.#...#...#...#...#.....#...#.#.#.....#.....#.#
  #.###.###.###.#.#.#.#.###.###########.#.#####.#.#.#.#.#.#.#.#.#######.###.###.#########.#.#.#.#.###.#.#.#####.#
  #.#.#...#...#.#.#.#.#.#.#.......#.....#.....#...#...#.#.........#.......#...#.........#.#.#.#...#.#.#...#.#.#.#
  #.#.###.###.###.#.#.#.#.#.#########.#####.#####.#######.#.#########.#########.###########.#####.#.###.#.#.#.#.#
  #.#.#.........#.#.#.#...#...#      O     X     C       H C         O         U    #.....#.#.#...#...#.#.#.#.#.#
  #.#.#######.###.#.#.#.###.###      V     H     D       W N         M         D    ###.###.#.###.###.###.#.#.#.#
  #...................#.......#                                                     #.#.......#.#.#...#.....#...#
  #####.###.###.#.#.#.#.###.#.#                                                     #.#.###.#.#.#.###.#####.###.#
  #.#...#.....#.#.#.#...#.#.#..VW                                                 CA..#.#...#...............#....UD
  #.#######.###.#.###.#.#.#.#.#                                                     #.#######.###########.###.#.#
PW..#.......#.#.#.#...#.#...#.#                                                     #.#.........#...........#.#.#
  #.###.###.#.###########.###.#                                                     #.#.#.###.#######.#######.###
  #.......#.........#...#.#...#                                                     #.#.#.#...#...#...#...#.#...#
  #######.#.###.#######.#######                                                     #.#.#####.#.#####.#.#.#.#.###
  #.#...#.#.#...#.........#...#                                                     #.....#.#.#.#...#...#.......#
  #.#.#######.#####.###.#####.#                                                     #######.###.#.###############
CD..#.#.#...#.#.#.....#.#.#.#..KT                                                 QD......#...#.................#
  #.#.#.###.###.#####.#.#.#.#.#                                                     #####.#.#.#.###.###.#.###.###
  #.....#...#.#.......#.....#.#                                                     #.....#.#...#.....#.#.#.....#
  #.#.#####.#.#.#.###.#.#.#.#.#                                                     #.#.###.#.#.###.###.#.###.#.#
  #.#...........#...#.#.#.#...#                                                     #.#.#...#.#...#...#.#.#.#.#..GK
  ###########################.#                                                     #.###.#.#####.#.#######.###.#
  #.....................#.#...#                                                     #.....#...#.#.#...#.#.....#.#
  #.#####.#.#####.#.###.#.#####                                                     #######.###.#######.###.#.###
  #...#.#.#...#...#...#.....#.#                                                     #.....#.#...#.......#.#.#...#
  ###.#.###.#####.#.###.###.#.#                                                     #.###.#####.###.#.#.#.#####.#
  #.#.....#.#.#...#.#...#.#.#.#                                                   AI..#.#.....#.....#.#.#...#....MO
  #.###.#####.#######.#.#.#.#.#                                                     #.#.#####.#.###.###.#.#####.#
VW............#.#...#.#.#......XU                                                   #.#...#.......#.#.........#.#
  ###.#.#.#####.###.###########                                                     ###.###.###########.#####.#.#
  #...#.#.....#.#.#.......#...#                                                     #.....#.#.#...#...#.#...#...#
  #########.###.#.#.#.#.###.#.#                                                     #.###.#.#.#.###.#####.#######
OM....#.#.#.#...#...#.#.#.#.#.#                                                     #.#...#.#.......#.......#...#
  #.###.#.#####.###.#####.#.#.#                                                     ###.#.###.###.###.#####.#.#.#
  #...#...#...#.....#.#.....#.#                                                     #...#...#...#.....#.#.#...#..ZL
  ###.#.#.###.#.###.#.#####.#.#                                                     ###.###.#.###.#####.#.###.#.#
  #.#...#.......#...........#..TD                                                 MO......#...#.#...#.#...#...#.#
  #.#####################.#####                                                     ###########.#####.#.#########
  #...................#...#...#                                                     #...................#...#...#
  #.#####.#.#.#.#####.#####.#.#                                                     ###.#.###.###.#####.###.#.#.#
  #.....#.#.#.#...#.#.#.#...#.#                                                     #...#.#...#.....#.....#.#.#.#
  #####.#####.#.###.#.#.###.#.#                                                     #.#.#.#############.###.#.#.#
AF....#...#.#.#...#.........#.#                                                   GD..#.#.#.#...#...#.........#..KT
  #.#.#.###.###.#####.#######.#                                                     #######.###.###.#######.#####
  #.#.....#...#.#...#.#.#...#..UP                                                 GK....#.#...............#.#...#
  ###.#####.#####.###.#.#.###.#                                                     #.#.#.###.###.#.###.#######.#
  #...#...#...#.....#.#.....#.#                                                     #.#...#.....#.#...#.....#.#.#
  #####.###.###.#########.#.###                                                     ###.#.#.#####.#.###.###.#.#.#
  #...#.#.#.....#.....#.#.#...#                                                     #...#.#.....#.#.#...#...#....RC
  #.###.#.#.###.###.#.#.#.###.#                                                     #####.#.#############.#####.#
  #...#.#.....#.#...#.#.....#.#                                                     #.#.......#.....#.#.#.......#
  #.###.#####.#.#.###.#.#.###.#                                                     #.#.#.###.#.###.#.#.#######.#
ZE............#.....#...#...#..LH                                                   #.#.#.#.#.#.#.......#...#...#
  #.#.#################.#######                                                     #.#####.#########.#.#.#.#####
  #.#...#.#.#.....#.#.#.#.....#                                                     #.#.#.........#.#.#...#.....#
  #######.#.#.#.#.#.#.#.###.#.#                                                     #.#.###.#.#.###.#.#######.###
  #...........#.#.#...#.#...#..JN                                                 AF..#...#.#.#.#.#...#.....#.#..JN
  #####.#######.###.#######.###                                                     #.#.###.#.###.###.#.###.#.#.#
  #...........#.....#...#.#...#                                                     #.......#.........#.#.......#
  #########.#####.###.###.#.###                                                     #.#.#####.#######.###.###.#.#
QD..............#.............#                                                     #.#.#...........#.#.....#.#.#
  #.#.###.###.#####.#.###.###.#      Q           Z       R   P           R   Z      #####.###.#######.#######.###
  #.#.#.#.#.......#.#.#.#.#...#      G           L       C   W           Y   E      #...#.#.....#.#...#.........#
  #.###.#.#.#.#######.#.#.#.#.#######.###########.#######.###.###########.###.#######.###.###.#.#.#.#.###.###.#.#
  #...#...#.#.#...#.....#.#.#...#.........#.......#...#...#.....#.........#.........#...#.#...#.#.#.#.#...#...#.#
  #.###.#.#####.###.#.#######.###.###.#.#####.###.#.###.###.#####.#.#####.###.#.#.###.#######.###.#.#.###.###.#.#
  #...#.#...#.#...#.#...#.....#...#...#...#...#.#.#...#.#.#...#.#.#.#...#.#...#.#...........#...#...#.#...#...#.#
  #.#.###.###.#.#####.#######.###.#####.###.###.###.#.#.#.###.#.###.#.###########.#.#.#############.#.###.#.#.#.#
  #.#.#.......#...#.....#.......#.#.#...#.......#...#.....#.#...#.....#.#...#.....#.#...#.#.#.#.....#.#...#.#.#.#
  #.###.#.#.#####.###.#.###.#.#####.#.#####.#.#####.#######.#.#######.#.#.#####.#.#.###.#.#.#.###.###.###.#.###.#
  #...#.#.#...#.......#.#...#.#.#...#.....#.#...#.#.....#.........#.....#.#.#...#.#...#.......#...#.....#.#...#.#
  #.#######.###.#.###.#########.#.#.#.###.###.#.#.#.#.#####.###.#####.###.#.#.#.###.#####.#.#.###.###.#####.#####
  #.....#...#...#...#...#.......#.#.#.#.....#.#.#.#.#.#.#.....#.#.......#.....#.#.......#.#.#...#.#.#.#.....#...#
  #.#.#.###.#.###.###.###.#####.#.#.###.#.###.###.#.#.#.###.#####.#.###.###.#######.#####.#########.#.###.#.###.#
  #.#.#...#.#...#.#.....#.#.......#.....#.#...#.#.#.#.....#.#.....#.#...#.....#.#.....#.#...#.......#.#...#.....#
  #.###.#.###.###.#.#.#.#####.#####.#####.#.###.#.#######.#.#####.#.#######.###.#######.#######.###.###.#.#.#####
  #.#...#.#.#...#.#.#.#.#.....#.#.......#.#.#.#...........#.#.#...#...#.........#.......#.#.......#.#.#.#.#.....#
  #.#.#.###.#.###.#####.###.###.###.#######.#.#########.###.#.#####.###.###.#########.###.###.#####.#.#####.#.#.#
  #.#.#.#.......#.#.....#.#.#...........#.....#...#.#.....#...#.#.....#.#...#...........#.....#.#.#.#...#...#.#.#
  #.#######.#######.#.###.#.#######.#.#.###.#####.#.###.###.###.###.#######.#######.#####.###.#.#.###.#####.#####
  #.....#...#.......#.....#.#.#.#...#.#.#.#...#.....#.#...#...#...#.#.#.#.#.#.....#.........#.....#.....#.#.#...#
  #.#.#.#.#.###.#.###########.#.###.#.#.#.#.###.###.#.###.#.#####.#.#.#.#.#.#.#####.#####.#####.#.#.###.#.#.###.#
  #.#.#.#.#...#.#.#.#.......#.......#.#.#.........#.#.....#...#.#...#.....#...........#.#.....#.#.....#.#.......#
  #.###.###.#.#####.#######.###.###.#########.###.#####.#.#.###.###.###.#.#######.#.#.#.###.###.#.#########.#.###
  #.#...#.#.#...#.#.#.#.#.........#.#...#.......#.#...#.#.#.......#...#.#.#.....#.#.#.#...#...#.#.#.....#...#...#
  #######.#.#.#.#.#.#.#.###########.###.###.#####.#.#####.###.###.###.#.#.#.#.###.#.###.#.#########.#######.#.###
  #.....#...#.#.#.....#.....#.#.........#.......#.#.........#.#...#.....#.#.#.....#.....#.#...#.........#.#.#...#
  ###.#.###.#######.###.#.#.#.#.#.#.###.#######.#######.###.###.#########.#.###.#.#.#.#.###.#######.###.#.###.###
  #...#...........#.....#.#.....#.#...#...#...#.#...#.#...#.#.....#.......#...#.#.#.#.#.....#.#.......#.....#...#
  #.#.###.#.#.#.#####.###.#.#.#####.###.#.#.#.#.#.#.#.#.#######.#####.#.#.###.#.#.###.#.###.#.###.#.#########.#.#
  #.#.#...#.#.#.#.......#.#.#.#.....#...#.#.#.....#.#.......#...#.....#.#.#...#.#...#.#...#.......#.........#.#.#
  ###################################.#####.#########.#.#######.###.#.#####.#####################################
                                     X     T         Z A       C   G A     R
                                     U     D         Z I       A   D A     Y                                       )";

constexpr char input21[] = R"()";

constexpr char input22[] = R"()";

constexpr char input23[] = R"()";

constexpr char input24[] = R"()";

constexpr char input25[] = R"()";
